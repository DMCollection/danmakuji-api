(function(e){function t(t){for(var a,r,o=t[0],c=t[1],l=t[2],d=0,m=[];d<o.length;d++)r=o[d],s[r]&&m.push(s[r][0]),s[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);u&&u(t);while(m.length)m.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,o=1;o<n.length;o++){var c=n[o];0!==s[c]&&(a=!1)}a&&(i.splice(t--,1),e=r(r.s=n[0]))}return e}var a={},s={1:0},i=[];function r(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=a,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=c;i.push([34,0]),n()})({"+Rab":function(e,t,n){"use strict";var a=n("iz4U"),s=n.n(a);s.a},"1gzD":function(e,t,n){},"2NF1":function(e,t,n){},34:function(e,t,n){e.exports=n("Vtdi")},"4oq/":function(e,t,n){},"4u1O":function(e,t,n){"use strict";var a=n("n6MI"),s=n.n(a);s.a},"51L2":function(e,t,n){},"5HVd":function(e,t,n){"use strict";var a=n("oTPr"),s=n.n(a);s.a},"7/7d":function(e,t,n){},"7rLg":function(e,t,n){"use strict";var a=n("1gzD"),s=n.n(a);s.a},"8fAS":function(e,t,n){},"9/oT":function(e,t,n){"use strict";var a=n("kI7O"),s=n.n(a);s.a},9545:function(e,t,n){"use strict";var a=n("e5wg"),s=n.n(a);s.a},"9EnR":function(e,t,n){},A0R8:function(e,t,n){"use strict";var a=n("EeS9"),s=n.n(a);s.a},D7j0:function(e,t,n){},Dh8X:function(e,t,n){},EDI0:function(e,t,n){},EeS9:function(e,t,n){},GbT4:function(e,t,n){},HNtT:function(e,t,n){"use strict";var a=n("4oq/"),s=n.n(a);s.a},Iklr:function(e,t,n){"use strict";var a=n("8fAS"),s=n.n(a);s.a},JOII:function(e,t,n){"use strict";var a=n("GbT4"),s=n.n(a);s.a},LNHh:function(e,t,n){"use strict";var a=n("hAJP"),s=n.n(a);s.a},Owhu:function(e,t,n){},SQog:function(e,t,n){"use strict";var a=n("XfUD"),s=n.n(a);s.a},T4ZT:function(e,t,n){"use strict";var a=n("aH7E"),s=n.n(a);s.a},THJW:function(e,t,n){},UGpJ:function(e,t,n){"use strict";var a=n("7/7d"),s=n.n(a);s.a},UPlX:function(e,t,n){"use strict";var a=n("bjQU"),s=n.n(a);s.a},Vtdi:function(e,t,n){"use strict";n.r(t);n("VRzm");var a=n("Kw5r"),s=n("XJYT"),i=n.n(s),r=(n("D66Q"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)}),o=[],c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"home"}},[n("el-container",{staticStyle:{"z-index":"1000",position:"fixed",height:"60px","background-color":"transparent",width:"100%",right:"0",top:"0"}},[n("el-header",{staticStyle:{"background-color":"rgba(20,20,34,0.9)","text-align":"right","font-size":"12px"}},[n("el-dropdown",[n("div",{staticClass:"avatar-wrapper"},[n("img",{staticClass:"avatar",attrs:{src:e.userInfo.face?e.userInfo.face:"/static/akari.jpg"}})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",[e._v(e._s(e.userInfo.nick))]),n("div",{on:{click:e.logout}},[n("el-dropdown-item",[e._v("登出")])],1)],1)],1)],1)],1),n("el-container",{staticStyle:{"margin-top":"60px"}},[n("el-aside",{staticStyle:{"margin-right":"20px"},attrs:{width:"200px"}},[n("el-menu",{attrs:{"background-color":"#262633","text-color":"#f9efc1",router:!0,"active-text-color":"#d8c13a","default-active":e.activeIndex}},[n("el-menu-item",{attrs:{route:{path:"/home/index"},index:"0"}},[e._v("\n          DARKER后台首页\n        ")]),n("el-submenu",{attrs:{index:"1"}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-message"}),e._v("番剧管理")]),n("el-menu-item",{attrs:{route:{path:"/home/bangumi"},index:"1-1"}},[e._v("番剧列表")]),n("el-menu-item",{attrs:{route:{path:"/home/bangumiedit"},index:"#"}},[e._v("新增番剧")]),n("el-menu-item",{attrs:{route:{path:"/home/bangumi/userpost"},index:"1-3"}},[e._v("提交列表")])],2),n("el-submenu",{attrs:{index:"2"}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-message"}),e._v("剧集管理")]),n("el-menu-item",{attrs:{route:{path:"/home/episode"},index:"2-1"}},[e._v("剧集列表")]),n("el-menu-item",{attrs:{index:"#"}},[e._v("新增剧集")])],2),n("el-submenu",{attrs:{index:"3"}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-message"}),e._v("视频管理")]),n("el-menu-item",{attrs:{route:{path:"/home/video"},index:"3-1"}},[e._v("视频列表")]),n("el-menu-item",{attrs:{route:{path:"/home/video/userpost"},index:"3-2"}},[e._v("提交列表")]),n("el-menu-item",{attrs:{index:"#"}},[e._v("新增视频")])],2),n("el-submenu",{attrs:{index:"4"}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-message"}),e._v("弹幕管理")]),n("el-menu-item",{attrs:{route:{path:"/home/danmaku"},index:"4-1"}},[e._v("弹幕列表")]),n("el-menu-item",{attrs:{index:"#"}},[e._v("被举报弹幕")]),n("el-menu-item",{attrs:{index:"#"}},[e._v("弹幕过滤规则")]),n("el-menu-item",{attrs:{route:{path:"/home/reportlist"},index:"4-4"}},[e._v("举报列表")])],2),n("el-submenu",{attrs:{index:"5"}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-message"}),e._v("用户管理")]),n("el-menu-item",{attrs:{route:{path:"/home/user"},index:"5-1"}},[e._v("用户列表")]),n("el-menu-item",{attrs:{index:"#"}},[e._v("锁定用户")])],2),n("el-submenu",{attrs:{index:"6"}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-message"}),e._v("公告管理")]),n("el-menu-item",{attrs:{route:{path:"/home/announce"},index:"6-1"}},[e._v("公告列表")]),n("el-menu-item",{attrs:{route:{path:"/home/announce/new"},index:"6-2"}},[e._v("新增公告")]),n("el-menu-item",{attrs:{route:{path:"/home/snotice"},index:"6-3"}},[e._v("系统消息")])],2),n("el-menu-item",{attrs:{route:{path:"/home/log"},index:"7"}},[e._v("\n          后台系统日志\n        ")]),n("el-menu-item",{attrs:{route:{path:"/home/apitest"},index:"8"}},[e._v("\n          API JSON数据展示\n        ")])],1)],1),n("el-container",[n("el-main",{staticStyle:{"background-color":"#262633"}},[n("router-view")],1)],1)],1)],1)},l=[],u=n("vDqi"),d=n.n(u);d.a.interceptors.request.use(function(e){return localStorage.getItem("token")&&(e.headers.Authorization=localStorage.getItem("token")),e},function(e){return Promise.reject(e)}),d.a.interceptors.response.use(function(e){return e},function(e){if(e&&e.response){switch(e.response.status){case 403:e.message=e.response.data.msg;break;case 404:e.message="请求地址出错: ".concat(e.response.config.url);break;case 408:e.message="请求超时";break;case 500:e.message="服务器内部错误";break;default:e.message=e.response.data.msg;break}a["default"].prototype.$message({message:e.message,type:"error"})}return Promise.reject(e)});var m="https://admin.darker.me",p=function(e){return d.a.post("".concat(m,"/auth/login"),e)},g=function(){return d.a.get("".concat(m,"/auth/logout"))},h=function(e){return d.a.get("".concat(m,"/tokens"),e)},f=function(e,t){return d.a.get("".concat(m,"/replies"),{params:{epId:e,pn:t}})},v=function(){return d.a.get("".concat(m,"/admin/index/mainInfo"))},b=function(e,t){return d.a.get("".concat(m,"/admin/users"),{params:{pn:e,ps:t}})},y=function(e){return d.a.get("".concat(m,"/admin/users/").concat(e))},w=function(e,t,n){return d.a.get("".concat(m,"/admin/users/nick"),{params:{nick:e,pn:t,ps:n}})},x=function(e){return d.a.delete("".concat(m,"/admin/users/").concat(e))},_=function(e,t){return d.a.put("".concat(m,"/admin/users/").concat(e,"/lock/1/").concat(t))},k=function(e){return d.a.put("".concat(m,"/admin/users/").concat(e,"/lock/0"))},C=function(e,t,n){return d.a.put("".concat(m,"/admin/users/").concat(e,"/role/").concat(t),{pwd:n})},I=function(e,t){return d.a.get("".concat(m,"/admin/bangumis"),{params:{pageNum:e,pageSize:t}})},R=function(e,t,n){return d.a.get("".concat(m,"/admin/bangumis"),{params:{bangumiName:e,pageNum:t,pageSize:n}})},S=function(e){return d.a.get("".concat(m,"/admin/bangumis/").concat(e))},B=function(e){return d.a.post("".concat(m,"/admin/bangumis"),e)},E=function(e,t){return d.a.put("".concat(m,"/admin/bangumis/").concat(e),t)},T=function(e){return d.a.delete("".concat(m,"/admin/bangumis/").concat(e))},O=function(e){return d.a.delete("".concat(m,"/admin/bangumis"),{data:{bangumis:e}})},$=function(e,t){return d.a.get("".concat(m,"/admin/episodes"),{params:{pageNum:e,pageSize:t}})},U=function(e){return d.a.get("".concat(m,"/admin/episodes/").concat(e))},j=function(e,t,n){return d.a.get("".concat(m,"/admin/episodes/bid/").concat(e),{params:{pageNum:t,pageSize:n}})},N=function(e){return d.a.post("".concat(m,"/admin/episodes"),e)},D=function(e,t){return d.a.put("".concat(m,"/admin/episodes/").concat(e),t)},L=function(e){return d.a.delete("".concat(m,"/admin/episodes/").concat(e))},A=function(e){return d.a.delete("".concat(m,"/admin/episodes"),e)},z=function(e,t,n){return d.a.get("".concat(m,"/admin/videos/eid/").concat(e),{params:{pageNum:t,pageSize:n}})},P=function(e,t,n){return d.a.get("".concat(m,"/admin/videos"),{params:{isMatch:e,pageNum:t,pageSize:n}})},M=function(e,t,n,a){return d.a.get("".concat(m,"/admin/videos/eid/").concat(e),{params:{isMatch:t,pageNum:n,pageSize:a}})},q=function(e){return d.a.post("".concat(m,"/admin/videos"),e)},V=function(e,t){return d.a.put("".concat(m,"/admin/videos/").concat(e),t)},F=function(e){return d.a.delete("".concat(m,"/admin/videos/").concat(e))},H=function(e){return d.a.delete("".concat(m,"/admin/videos"),e)},G=function(e,t){return d.a.get("".concat(m,"/admin/postBangumis"),{params:{pn:e,ps:t}})},Q=function(e,t,n){return d.a.get("".concat(m,"/admin/postBangumis"),{params:{pbs:e,pn:t,ps:n}})},J=function(e,t,n,a){return d.a.get("".concat(m,"/admin/postBangumis"),{params:{bt:e,et:t,pn:n,ps:a}})},Z=function(e){return d.a.get("".concat(m,"/admin/postBangumis"),{params:e})},W=function(e){return d.a.put("".concat(m,"/admin/postBangumis/").concat(e),{type:1})},K=function(e,t,n){return d.a.put("".concat(m,"/admin/postBangumis/").concat(e),{type:t,msg:n})},X=function(e){return d.a.post("".concat(m,"/admin/notices"),e)},Y=function(e){return d.a.get("".concat(m,"/admin/notices"),{params:{pn:e}})},ee=function(e){return d.a.put("".concat(m,"/admin/notices"),e)},te=function(e){return d.a.delete("".concat(m,"/admin/notices/").concat(e))},ne=function(e){return d.a.get("".concat(m).concat(e))},ae=function(e,t,n){return d.a.get("".concat(m,"/admin/online"),{params:{t:n,pn:e,ps:t}})},se=function(e,t,n){return d.a.post("".concat(m,"/admin/messages"),{type:e,title:t,content:n})},ie=function(e,t,n){return d.a.post("".concat(m,"/admin/messages/users"),{ids:e,title:t,content:n})},re=function(e){return d.a.delete("".concat(m,"/admin/messages/").concat(e))},oe=function(e){return d.a.delete("".concat(m,"/admin/messages/users/messages"),{data:{mids:e}})},ce=function(e,t){return d.a.get("".concat(m,"/admin/messages"),{params:{pn:e,ps:t}})},le=function(){return d.a.get("".concat(m,"/index/is"))},ue=function(e){return d.a.post("".concat(m,"/admin/index/is"),e)},de=function(e){return d.a.post("".concat(m,"/admin/index/recommend"),e)},me=function(e,t){return d.a.put("".concat(m,"/admin/index/recommend/").concat(e),t)},pe=function(e){return d.a.delete("".concat(m,"/admin/index/recommend/").concat(e))},ge=function(e,t,n){return d.a.get("".concat(m,"/admin/index/recommend"),{params:{pn:e,ps:t,sort:n}})},he=function(e){return d.a.get("".concat(m,"/admin/index/recommend/").concat(e))},fe=function(){return d.a.get("".concat(m,"/actuator/logfile"))},ve=function(){return d.a.post("".concat(m,"/actuator/shutdown"))},be=function(e,t,n){return d.a.get("".concat(m,"/admin/reports"),{params:{pn:e,ps:t,type:n}})},ye=function(e,t){return d.a.post("".concat(m,"/admin/reports/").concat(e),t)},we={baseURL:m,login:p,logout:g,checkToken:h,getReplies:f,getSystemMainInfo:v,getUsers:b,getUserByUid:y,searchUsersByNick:w,deleteUser:x,lockUser:_,unlockUser:k,changeUserRole:C,getBangumis:I,searchBangumisByName:R,getBangumiById:S,addBangumi:B,editBangumi:E,deleteBangumi:T,deleteBangumis:O,getEpisodes:$,getEpisodeById:U,getEpisodesByBangumiId:j,addEpisode:N,editEpisode:D,deleteEpisode:L,deleteEpisodes:A,getVideos:P,getVideosByEpisodeId:M,getRelatedVideosByEpisodeId:z,addVideo:q,editVideo:V,deleteVideo:F,deleteVideos:H,getUserPostBangumis:G,getUserPostBangumisByPbs:Q,getUserPostBangumisByTime:J,getUserPostBangumisByParams:Z,acceptUserPostBangumi:W,declineUserPostBangumi:K,getNotices:Y,postNotice:X,editNotice:ee,deleteNotice:te,apiRequest:ne,getOnlineUsers:ae,sendSystemNoticeByType:se,sendSystemNoticeByIds:ie,deleteSystemNotice:re,deleteIdsSystemNotice:oe,getSystemNotice:ce,getWellcome:le,setWellcome:ue,addRecommend:de,updateRecommend:me,deleteRecommend:pe,getRecommends:ge,getRecommendById:he,getLogs:fe,shutDownApp:ve,getReorts:be,handleReport:ye},xe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"api-test"},[n("el-collapse",{on:{change:e.handleChange}},[n("el-collapse-item",{attrs:{title:"replies",name:"1"}},[n("div",{staticClass:"rpy-json"},[n("div",{staticClass:"rpy-input"},[n("span",[e._v("episode id")]),n("el-input",{staticStyle:{width:"100px"},attrs:{size:"small"},model:{value:e.epId,callback:function(t){e.epId=t},expression:"epId"}})],1),n("div",{staticClass:"rpy-input"},[n("span",[e._v("page number")]),n("el-input",{staticStyle:{width:"100px"},attrs:{size:"small"},model:{value:e.pn,callback:function(t){e.pn=t},expression:"pn"}})],1),n("el-button",{attrs:{type:"primary"},on:{click:e.getReplyJson}},[e._v("获取replies")]),e.jsonResult?n("div",{staticClass:"content"},[n("tree-view",{attrs:{data:e.jsonResult,options:e.options}})],1):e._e()],1)])],1),n("div",{staticClass:"img-api"},[n("el-upload",{staticClass:"avatar-uploader",attrs:{action:"https://api.imgur.com/3/image",headers:e.GLOBAL.uploadHEADERS,name:"image","show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[n("img",{directives:[{name:"show",rawName:"v-show",value:e.imgurl,expression:"imgurl"}],staticClass:"upload-img",attrs:{src:e.imgurl}}),n("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),n("tree-view",{attrs:{data:e.imgResult}})],1),n("div",{staticStyle:{"margin-top":"100px"}},[n("el-input",{model:{value:e.myURL,callback:function(t){e.myURL=t},expression:"myURL"}}),n("el-button",{on:{click:e.sendRequest}},[e._v("发送")]),n("tree-view",{attrs:{data:e.myResult}})],1)],1)},_e=[],ke=(n("tUrg"),n("ls82"),n("MECJ")),Ce=(n("pIFo"),{name:"ApiTest",data:function(){return{epId:15,pn:1,jsonResult:"",options:{maxDepth:2,rootObjectKey:"replies",modifiable:!1},imgurl:"",imgResult:"",myURL:"",myResult:"",splitRes:""}},computed:{getLogText:function(){return this.myResult?this.myResult.substring(0,2e3).replace(/\n/g,"<br>"):"no result"}},methods:{getReplyJson:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.epId&&this.pn){e.next=3;break}return this.$message({message:"参数有误",type:"error"}),e.abrupt("return");case 3:return e.next=5,we.getReplies(this.epId,this.pn);case 5:t=e.sent,n=t.data,console.log(n),this.jsonResult=n;case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),handleChange:function(e){console.log(e)},handleAvatarSuccess:function(e,t){console.log("handleAvatarSucc invoked!"),console.log(e),console.log(t),this.imgResult=e.data,this.imgurl=e.data.link,console.log(this.imgResult)},beforeAvatarUpload:function(e){console.log("file ",e);var t=e.size/1024/1024<4;return t||this.$message.error("上传头像图片大小不能超过 4MB!"),t},sendRequest:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(""!==this.myURL){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,we.apiRequest(this.myURL);case 4:t=e.sent,n=t.data,this.myResult=n;case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}}),Ie=Ce,Re=(n("UGpJ"),n("LNHh"),n("KHd+")),Se=Object(Re["a"])(Ie,xe,_e,!1,null,"121fa5e4",null),Be=Se.exports,Ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-container"},[n("div",{staticClass:"filter-container"},[n("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"用户昵称"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.handleSearch(t):null}},model:{value:e.query.nick,callback:function(t){e.$set(e.query,"nick",t)},expression:"query.nick"}}),n("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{circle:"",type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}}),n("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(t){e.showAddUserDialog=!0}}},[e._v("添加")]),n("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-delete"}},[e._v("批量删除")]),n("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:e.getUsersList}},[e._v("显示有用户")])],1),n("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{height:"600",data:e.list,"element-loading-text":"loading...",border:"","highlight-current-row":""}},[n("el-table-column",{attrs:{type:"selection",width:"35"}}),n("el-table-column",{attrs:{align:"center",label:"id"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.userId))])]}}])}),n("el-table-column",{attrs:{label:"用户名",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticClass:"nick-link"},[n("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover"}},[n("div",{staticClass:"short-user-info"},[n("div",{staticClass:"u-avatar-wrapper"},[n("img",{staticClass:"u-avatar-img",attrs:{src:t.row.face?t.row.face:"/static/akari.jpg"}})]),n("div",{staticClass:"u-other-info"},[n("span",{staticClass:"user-nick-link"},[n("a",{attrs:{target:"_blank",href:"#/home/userdetail/"+t.row.userId}},[e._v("\n                  "+e._s(t.row.nick)+"\n                ")])]),n("span",[e._v("\n                "+e._s(t.row.sex)+"\n              ")]),n("span",[e._v("\n                "+e._s(t.row.age)+"\n              ")]),n("span",[e._v("\n                "+e._s(t.row.role)+"\n              ")])])]),n("a",{attrs:{slot:"reference",target:"_blank",href:"#/home/userdetail/"+t.row.userId},slot:"reference"},[e._v("\n            "+e._s(t.row.nick)+"\n          ")])])],1)]}}])}),n("el-table-column",{attrs:{prop:"role",filters:e.roles,"filter-method":e.roleFilter,label:"角色",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return["ROLE_USER"===t.row.role?n("el-button",{attrs:{type:"success",size:"small"},on:{click:function(n){e.changeRole(t.row,1)}}},[e._v("提升为管理员")]):e._e(),"ROLE_MANAGER"===t.row.role?n("el-button",{attrs:{type:"info",size:"small"},on:{click:function(n){e.changeRole(t.row,2)}}},[e._v("提升为系统管理员")]):e._e(),"ROLE_ADMIN"===t.row.role?n("el-button",{attrs:{type:"warning",size:"small"},on:{click:function(n){e.changeRole(t.row,0)}}},[e._v("撤销管理员")]):e._e()]}}])}),n("el-table-column",{attrs:{align:"center",label:"注册时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e._f("formatDate")(t.row.createTime)))])]}}])}),n("el-table-column",{attrs:{align:"center",label:"邮箱",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.email))])]}}])}),n("el-table-column",{attrs:{align:"center",label:"锁定",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(1===t.row.isLock?"是":"否"))]),1===t.row.isLock?n("el-button",{attrs:{type:"success",size:"small"},on:{click:function(n){e.unlockUser(t.row)}}},[e._v("解封")]):e._e(),0===t.row.isLock?n("el-button",{attrs:{type:"warning",size:"small"},on:{click:function(n){e.lockUser(t.row)}}},[e._v("封禁")]):e._e()]}}])}),n("el-table-column",{attrs:{align:"center",label:"解除锁定日期",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e._f("formatDate")(t.row.lockTime)))])]}}])}),n("el-table-column",{attrs:{prop:"sex",filters:[{text:"男",value:"男"},{text:"女",value:"女"},{text:"不明",value:"不明"}],"filter-method":e.sexFilter,align:"center",label:"性别",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.sex))])]}}])}),n("el-table-column",{attrs:{label:"年龄",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n      "+e._s(t.age)+"\n    ")]}}])}),n("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(n){e.handleEdit(t.row.userId,t.row)}}}),n("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(n){e.handleDelete(t.$index,t.row)}}})]}}])})],1),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.listLoading,expression:"!listLoading"}],staticClass:"pagination-container"},[n("el-pagination",{attrs:{"current-page":e.page.pageNumber,"page-sizes":[10,20,30,50],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.totalSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.page,"pageNumber",t)}}})],1),n("el-dialog",{attrs:{title:"添加用户",visible:e.showAddUserDialog},on:{"update:visible":function(t){e.showAddUserDialog=t}}},[n("el-form",{staticClass:"small-space",staticStyle:{width:"400px","margin-left":"50px"},attrs:{model:e.temp,"label-position":"left","label-width":"70px"}},[n("el-form-item",{attrs:{label:"昵称"}},[n("el-input",{model:{value:e.temp.nick,callback:function(t){e.$set(e.temp,"nick",t)},expression:"temp.nick"}})],1),n("el-form-item",{attrs:{label:"邮箱"}},[n("el-input",{model:{value:e.temp.email,callback:function(t){e.$set(e.temp,"email",t)},expression:"temp.email"}})],1),n("el-form-item",{attrs:{label:"电话"}},[n("el-input",{model:{value:e.temp.phone,callback:function(t){e.$set(e.temp,"phone",t)},expression:"temp.phone"}})],1),n("el-form-item",{attrs:{label:"年龄"}},[n("el-input",{model:{value:e.temp.age,callback:function(t){e.$set(e.temp,"age",t)},expression:"temp.age"}})],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.showAddUserDialog=!1}}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.handleAddUser}},[e._v("确 定")])],1)],1)],1)},Te=[];n("Oyvg");function Oe(e,t){/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds()};for(var a in n)if(new RegExp("(".concat(a,")")).test(t)){var s=n[a]+"";t=t.replace(RegExp.$1,1===RegExp.$1.length?s:$e(s))}return t}function $e(e){return("00"+e).substr(e.length)}var Ue={name:"UserList",data:function(){return{list:[],page:{},query:{nick:"",lastQuery:""},temp:{nick:"",email:"",phone:"",age:""},showAddUserDialog:!1,listLoading:!0,roles:[{text:"普通用户",value:"ROLE_USER"},{text:"管理员",value:"ROLE_ADMIN"},{text:"系统管理员",value:"ROLE_MANAGER"}],checkList:[]}},filters:{formatDate:function(e){var t=new Date(e);return Oe(t,"yyyy-MM-dd hh:mm")}},mounted:function(){console.log("mounted! getUserList..."),this.getUsersList()},methods:{test:function(){console.log("click username!")},getUsersList:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.listLoading=!0,t=this.$route.query,console.log("获取到url参数：",t),e.next=5,we.getUsers(1,20);case 5:n=e.sent,console.log("getUsers result:"),console.log(n),a=n.data,0===a.code?(this.list=a.data.users,this.page=a.data.page,this.query.lastQuery="",console.log("获取所有用户:",a.data.users),console.log("分页信息：",a.data.page)):this.$message({showClose:!0,message:a.msg,type:"error"}),this.listLoading=!1;case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),resetForm:function(e){this.$refs[e].resetFields()},handleEdit:function(e,t){console.log("userId:"+e),console.log(t),console.log("edit row invoked!")},handleDelete:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t,n){var a,s=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:console.log("userId to be deleted:"+n.userId),a=!1,this.$confirm("删除用户："+n.nick,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",callback:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(i,r){var o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if("confirm"!==i){e.next=9;break}return console.log("del:"+a),console.log(r),e.next=5,we.deleteUser(n.userId);case 5:o=e.sent,0===o.data.code?(console.log("删除成功，uid:"+n.userId),console.log("index:"+t),s.$message({showClose:!0,message:o.data.msg,type:"success"}),s.list.splice(t,1)):s.$message({showClose:!0,message:o.data.msg,type:"error"}),e.next=10;break;case 9:s.$message({showClose:!0,message:"已取消删除",type:"info"});case 10:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()});case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),handleSearch:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("search nick:"+this.query.nick),""!==this.query.nick){e.next=4;break}return this.$message({showClose:!0,message:"请输入搜索内容",type:"info"}),e.abrupt("return");case 4:return e.next=6,we.searchUsersByNick(this.query.nick,1,20);case 6:t=e.sent,n=t.data,0===n.code?(this.list=n.data.users,this.page=n.data.page,this.query.lastQuery=this.query.nick,0===n.data.users.length&&this.$message({showClose:!0,message:"无搜索结果",type:"info"})):(this.list=[],this.page.totalSize=0,this.$message({showClose:!0,message:n.msg,type:"info"}));case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),handleSizeChange:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("每页"+t+"条"),""===this.query.lastQuery){e.next=7;break}return e.next=4,we.searchUsersByNick(this.query.lastQuery,1,t);case 4:n=e.sent,e.next=10;break;case 7:return e.next=9,we.getUsers(1,t);case 9:n=e.sent;case 10:a=n.data,console.log(a),0===a.code?(this.list=a.data.users,this.page=a.data.page):this.$message({showClose:!0,message:a.msg,type:"error"});case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),handleCurrentChange:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("curpage:"+t),""===this.query.lastQuery){e.next=7;break}return e.next=4,we.searchUsersByNick(this.query.lastQuery,t,this.page.pageSize);case 4:n=e.sent,e.next=10;break;case 7:return e.next=9,we.getUsers(t,this.page.pageSize);case 9:n=e.sent;case 10:a=n.data,console.log(a),0===a.code?(this.list=a.data.users,this.page=a.data.page):this.$message({showClose:!0,message:a.msg,type:"error"});case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),handleAddUser:function(){},roleFilter:function(e,t){return console.log("value:"+e),console.log("row.role:"+t.role),console.log(t.role===e),t.role===e},sexFilter:function(e,t){return t.sex===e},lockUser:function(e){var t=this;console.log("lockUser!"),console.log(e),this.$prompt("封禁时长：","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",callback:function(){var n=Object(ke["a"])(regeneratorRuntime.mark(function n(a,s){var i,r;return regeneratorRuntime.wrap(function(n){while(1)switch(n.prev=n.next){case 0:if("confirm"!==a){n.next=10;break}return console.log("封禁时间："+s.inputValue),n.next=4,we.lockUser(e.userId,s.inputValue);case 4:i=n.sent,r=i.data,console.log(r),0===r.code?(e.isLock=1,t.$message({showClose:!0,message:r.msg,type:"success"})):t.$message({showClose:!0,message:"封禁用户失败",type:"error"}),n.next=11;break;case 10:t.$message({showClose:!0,message:"已取消",type:"info"});case 11:case"end":return n.stop()}},n,this)}));return function(e,t){return n.apply(this,arguments)}}()})},unlockUser:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return console.log("unlockUser!"),e.next=3,we.unlockUser(t.userId);case 3:n=e.sent,a=n.data,console.log("unlock res:",a),0===a.code?(t.isLock=0,this.$message({showClose:!0,message:a.msg,type:"success"})):this.$message({showClose:!0,message:"解封用户失败",type:"error"});case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),changeRole:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t,n){var a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:console.log("changle role!"),console.log(t),this.$prompt("请输入密码","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",callback:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(s,i){var r,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if("confirm"!==s){e.next=11;break}return console.log("密码："+i.inputValue),e.next=4,we.changeUserRole(t.userId,n,i.inputValue);case 4:r=e.sent,o=r.data,console.log(o),0===o.code?(t.role=0===n?"ROLE_USER":1===n?"ROLE_MANAGER":"ROLE_ADMIN",a.$message({showClose:!0,message:o.msg,type:"success"})):a.$message({showClose:!0,message:o.msg,type:"error"}),a.$message({showClose:!0,message:o.msg,type:"success"}),e.next=12;break;case 11:a.$message({showClose:!0,message:"已取消",type:"info"});case 12:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()});case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()}},je=Ue,Ne=(n("UPlX"),Object(Re["a"])(je,Ee,Te,!1,null,"a2986470",null)),De=Ne.exports,Le={data:function(){return{activeIndex:"0",userInfo:{uid:"",nick:"",face:"",role:""}}},components:{ApiTest:Be,UserList:De},methods:{logout:function(){console.log("logout~!");var e=!1;localStorage.getItem("token")&&(e=!0),e&&we.logout(),localStorage.clear(),window.location.href="#/login"}},created:function(){this.userInfo.uid=localStorage.getItem("uid"),this.userInfo.nick=localStorage.getItem("nick"),this.userInfo.face=localStorage.getItem("face"),this.userInfo.role=localStorage.getItem("role")}},Ae=Le,ze=(n("9545"),Object(Re["a"])(Ae,c,l,!1,null,"d76a6dce",null)),Pe=ze.exports,Me={name:"app",components:{Home:Pe},data:function(){return{isLogin:!1}}},qe=Me,Ve=(n("ZL7j"),Object(Re["a"])(qe,r,o,!1,null,null,null)),Fe=Ve.exports,He=n("jE9Z"),Ge=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"loginctx",staticClass:"login-container"},[n("div",{staticClass:"login-box"},[n("h1",[e._v("LOGIN")]),n("div",{staticClass:"login-form"},[n("el-form",{ref:"Login",staticStyle:{"margin-left":"0","margin-right":"0"},attrs:{size:"small","label-position":"left","label-width":"40px",model:e.loginInfo}},[n("el-form-item",{attrs:{label:"账户"}},[n("el-input",{model:{value:e.loginInfo.principal,callback:function(t){e.$set(e.loginInfo,"principal",t)},expression:"loginInfo.principal"}})],1),n("el-form-item",{attrs:{label:"密钥"}},[n("el-input",{attrs:{type:"password"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.login(t):null}},model:{value:e.loginInfo.password,callback:function(t){e.$set(e.loginInfo,"password",t)},expression:"loginInfo.password"}})],1),n("el-form-item",{staticStyle:{"text-align":"left"}},[n("el-button",{attrs:{type:"primary"},on:{click:e.login}},[e._v("登入")])],1)],1)],1)])])},Qe=[],Je={data:function(){return{loginInfo:{principal:"",password:"",remember_me:0}}},methods:{login:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n,a,s,i,r,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(""!==this.loginInfo.principal&&""!==this.loginInfo.password){e.next=3;break}return this.$message({message:"账号或密码为空",type:"info"}),e.abrupt("return",!1);case 3:return e.next=5,we.login(this.loginInfo);case 5:if(t=e.sent,n=t.data,a="",s="",i="",r="",o="",console.log("login return data:",n.data),2002!==n.code&&null!=n.data){e.next=16;break}return this.$message({message:"账号不存在或密码错误",type:"error"}),e.abrupt("return",!1);case 16:if(0!==n.code&&"OK"!==n.msg){e.next=27;break}if(s=n.data.token,o=n.data.user.nick,a=n.data.user.uid,i=n.data.user.face,r=n.data.user.role,"ROLE_USER"!==r){e.next=26;break}return this.$message({message:"该用户没有权限",type:"error"}),window.location.href="#/login",e.abrupt("return");case 26:s||this.$message({message:"无法获取到Token",type:"error"});case 27:this.checkLocalStorage()&&(localStorage.setItem("uid",a),localStorage.setItem("token",s),localStorage.setItem("nick",o),localStorage.setItem("face",i),localStorage.setItem("role",r),window.location.href="#/home/index");case 28:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),checkLocalStorage:function(){return"undefined"!==typeof window.localStorage||(this.$message({message:"请关闭隐私模式,或者浏览器太老旧了,否则无法保存登录状态",type:"warning"}),!1)}}},Ze=Je,We=(n("5HVd"),Object(Re["a"])(Ze,Ge,Qe,!1,null,"3749c590",null)),Ke=We.exports,Xe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"index"},[n("div",{staticClass:"main-info"},[n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("在线用户")])]),n("div",{staticClass:"text item"},[n("a",{attrs:{href:"javascript:void(0);"},on:{click:e.getOnlineUsers}},[e._v(e._s(e.sysInfo.authOnline))])])]),n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("在线游客")])]),n("div",{staticClass:"text item"},[e._v("\n        "+e._s(e.sysInfo.anonOnline)+"\n      ")])]),n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("当前在线人数")])]),n("div",{staticClass:"text item"},[e._v("\n        "+e._s(e.sysInfo.totalOnline)+"\n      ")])]),n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("今日注册用户")])]),n("div",{staticClass:"text item"},[e._v("\n        "+e._s(e.sysInfo.newUsers)+"\n      ")])]),n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("用户总数")])]),n("div",{staticClass:"text item"},[e._v("\n        "+e._s(e.sysInfo.totalUsers)+"\n      ")])]),n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("游客总数")])]),n("div",{staticClass:"text item"},[e._v("\n        "+e._s(e.sysInfo.totalVisitors)+"\n      ")])]),n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("今日在线用户")])]),n("div",{staticClass:"text item"},[n("a",{attrs:{href:"javascript:void(0);"},on:{click:e.getTodayOnlineUsers}},[e._v(e._s(e.sysInfo.maxAuthOnline))])])]),n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("今日评论")])]),n("div",{staticClass:"text item"},[e._v("\n        "+e._s(e.sysInfo.newReplies)+"\n      ")])]),n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("今日在线游客")])]),n("div",{staticClass:"text item"},[e._v("\n        "+e._s(e.sysInfo.maxAnonOnline)+"\n      ")])]),n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("访问量")])]),n("div",{staticClass:"text item"},[e._v("\n        "+e._s(e.sysInfo.visit)+"\n      ")])])],1),n("div",{staticClass:"wellcome-container"},[n("div",{staticClass:"wellc-title"},[e._v("当前欢迎页内容")]),n("div",{staticClass:"w-content"},[e.edit?n("p",[n("el-input",{staticStyle:{width:"400px"},model:{value:e.tmpText,callback:function(t){e.tmpText=t},expression:"tmpText"}})],1):n("p",[e._v(e._s(e.wText))]),e.edit?n("div",{staticClass:"edit-wellcome"},[n("i",{staticClass:"el-icon-success save-icon",staticStyle:{"margin-right":"5px"},on:{click:e.handleSave}}),n("i",{staticClass:"el-icon-error discard-icon",on:{click:e.handleDiscard}})]):n("div",{staticClass:"edit-wellcome",on:{click:e.handleEdit}},[n("i",{staticClass:"el-icon-edit edit-icon"})])])]),n("div",{staticClass:"recommend-container"},[n("div",{staticClass:"recommend-operation"},[n("el-button",{attrs:{type:"primary"},on:{click:e.addNewRecommend}},[e._v("添加")]),n("el-button",{attrs:{type:"primary"},on:{click:e.showAllRecommend}},[e._v("显示全部推荐")]),n("el-button",{attrs:{type:"primary"},on:{click:e.showRecommend}},[e._v("显示首页的推荐")])],1),e._l(e.recommends,function(t,a){return n("div",{key:t.id,staticClass:"recommend-wrapper",class:{deletedRec:"DELETE"===t.recommendStatus}},[n("div",{staticStyle:{float:"right"}},[n("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(n){e.handleEditRecommend(t,a)}}}),n("el-button",{staticStyle:{float:"right"},attrs:{type:"danger",icon:"el-icon-delete",circle:"",disabled:"DELETE"===t.recommendStatus},on:{click:function(n){e.handleDeleteRecommend(t.id,a)}}})],1),n("img",{staticStyle:{width:"320px",height:"180px"},attrs:{src:t.imageUrl}}),n("p",[e._v("id:"+e._s(t.id))]),n("p",[e._v("title:"+e._s(t.title))]),n("p",[e._v("linkUrl:"+e._s(t.linkUrl))]),n("p",[e._v("创建时间："+e._s(t.createTime))]),n("p",[e._v("修改时间："+e._s(t.modifyTime))]),n("p",[e._v("状态："+e._s(t.recommendStatus))]),n("p",[e._v("publisherId:"+e._s(t.publisherId))]),n("p",[e._v("在首页展示："+e._s(t.showIndex))])])}),e.page?n("div",{staticClass:"pagination-container"},[n("el-pagination",{attrs:{"current-page":e.page.pageNumber,layout:"total, sizes, prev, pager, next, jumper",total:e.page.totalSize},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.page,"pageNumber",t)}}})],1):e._e(),n("el-dialog",{attrs:{"before-close":e.clearTempRecommend,title:"修改推荐",visible:e.showAddRecommend},on:{"update:visible":function(t){e.showAddRecommend=t}}},[n("el-form",{staticClass:"small-space",staticStyle:{"margin-left":"50px"},attrs:{model:e.tmpRecommend,"label-position":"left","label-width":"70px"}},[n("el-form-item",{attrs:{label:"标题"}},[n("el-input",{model:{value:e.tmpRecommend.title,callback:function(t){e.$set(e.tmpRecommend,"title",t)},expression:"tmpRecommend.title"}})],1),n("el-form-item",{attrs:{label:"链接"}},[n("el-input",{model:{value:e.tmpRecommend.linkUrl,callback:function(t){e.$set(e.tmpRecommend,"linkUrl",t)},expression:"tmpRecommend.linkUrl"}})],1),n("el-form-item",{attrs:{label:"图片链接"}},[n("el-input",{model:{value:e.tmpRecommend.imageUrl,callback:function(t){e.$set(e.tmpRecommend,"imageUrl",t)},expression:"tmpRecommend.imageUrl"}}),n("img",{directives:[{name:"show",rawName:"v-show",value:e.tmpRecommend.imageUrl,expression:"tmpRecommend.imageUrl"}],staticStyle:{width:"320px",height:"180px"},attrs:{src:e.tmpRecommend.imageUrl}})],1),n("el-form-item",{attrs:{label:"是否显示"}},[n("el-switch",{attrs:{"active-color":"#3a86ef","inactive-color":"#777"},model:{value:e.tmpRecommend.showIndex,callback:function(t){e.$set(e.tmpRecommend,"showIndex",t)},expression:"tmpRecommend.showIndex"}})],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.cancelAddRecommend}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.handleAddRecommend}},[e._v("确 定")])],1)],1)],2)])},Ye=[],et=(n("Vd3H"),{name:"Index",data:function(){return{sysInfo:"",edit:!1,wText:"",tmpText:"",recommends:"",page:"",sort:1,tmpRecommend:{id:"",title:"",linkUrl:"",imageUrl:"",showIndex:""},showAddRecommend:!1}},methods:{initSystemInfo:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.getSystemMainInfo();case 2:t=e.sent,n=t.data,console.log("systemInfo:",n.data),this.sysInfo=n.data;case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getOnlineUsers:function(){console.log("get online users."),this.$router.push({name:"onlineuser"})},getTodayOnlineUsers:function(){console.log("get today online users."),this.$router.push({name:"onlineuser",params:{today:"today"}})},initWellcomeText:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.getWellcome();case 2:t=e.sent,n=t.data,0===n.code?this.wText=n.data:console.log("get wellcomeText err.");case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),updateWellcomeText:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(""!==t){e.next=3;break}return this.$message({message:"内容为空",type:"error"}),e.abrupt("return");case 3:return e.next=5,we.setWellcome({sentence:t});case 5:n=e.sent,a=n.data,console.log("rd:",a.data),0===a.code&&(this.wText=t,this.edit=!1,this.$message({message:"修改成功",type:"success"}));case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),handleEdit:function(){this.edit=!0,this.tmpText=this.wText},handleSave:function(){this.updateWellcomeText(this.tmpText)},handleDiscard:function(){this.edit=!1},initRecommend:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.getRecommends(1,10,1);case 2:t=e.sent,n=t.data,0===n.code&&(this.recommends=n.data.irs,this.page=n.data.page);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),handleCurrentChange:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.getRecommends(t,10,this.sort);case 2:n=e.sent,a=n.data,0===a.code?(this.recommends=a.data.irs,this.page=a.data.page):console.log("get recommends err.");case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),handleDeleteRecommend:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t,n){var a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.$confirm("删除推荐：","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",callback:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(s,i){var r,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(console.log(i),"confirm"!==s){e.next=7;break}return e.next=4,we.deleteRecommend(t);case 4:r=e.sent,o=r.data,0===o.code?(a.recommends.splice(n,1),a.$message({message:"删除成功",type:"success"})):a.$message({showClose:!0,message:o.msg,type:"error"});case 7:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()});case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),handleEditRecommend:function(e,t){t&&(this.tmpRecommend.id=e.id),console.log("edit recommend:",e),this.showAddRecommend=!0,this.tmpRecommend.title=e.title,this.tmpRecommend.linkUrl=e.linkUrl,this.tmpRecommend.imageUrl=e.imageUrl,this.tmpRecommend.showIndex=e.showIndex},handleAddRecommend:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.tmpRecommend.id){e.next=6;break}return e.next=3,we.updateRecommend(this.tmpRecommend.id,{title:this.tmpRecommend.title,linkUrl:this.tmpRecommend.linkUrl,imageUrl:this.tmpRecommend.imageUrl,showIndex:this.tmpRecommend.showIndex?1:0});case 3:t=e.sent,e.next=9;break;case 6:return e.next=8,we.addRecommend({title:this.tmpRecommend.title,linkUrl:this.tmpRecommend.linkUrl,imageUrl:this.tmpRecommend.imageUrl,showIndex:this.tmpRecommend.showIndex?1:0});case 8:t=e.sent;case 9:n=t.data,0===n.code&&(this.showAddRecommend=!1,this.tmpRecommend.title="",this.tmpRecommend.linkUrl="",this.tmpRecommend.imageUrl="",this.tmpRecommend.showIndex="",this.tmpRecommend.id="",this.initRecommend());case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),cancelAddRecommend:function(){this.tmpRecommend.title="",this.tmpRecommend.linkUrl="",this.tmpRecommend.imageUrl="",this.tmpRecommend.showIndex="",this.tmpRecommend.id="",this.showAddRecommend=!1},clearTempRecommend:function(e){this.tmpRecommend.title="",this.tmpRecommend.linkUrl="",this.tmpRecommend.imageUrl="",this.tmpRecommend.showIndex="",this.tmpRecommend.id="",e()},addNewRecommend:function(){this.showAddRecommend=!0},showAllRecommend:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.getRecommends(1,10,2);case 2:t=e.sent,n=t.data,0===n.code&&(this.sort=2,this.recommends=n.data.irs,this.page=n.data.page);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),showRecommend:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.sort=1,this.initRecommend();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},created:function(){this.initSystemInfo(),this.initWellcomeText(),this.initRecommend()}}),tt=et,nt=(n("byRC"),n("JOII"),Object(Re["a"])(tt,Xe,Ye,!1,null,"0ce33e88",null)),at=nt.exports,st=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-detail"},[n("div",{staticClass:"user-avatar-container"},[n("div",{staticClass:"user-avatar-wrapper"},[n("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.GLOBAL.uploadURL,name:"image",headers:e.GLOBAL.uploadHEADERS,"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[n("img",{staticClass:"user-avatar-img",attrs:{src:e.userInfo.face?e.userInfo.face:"/static/akari.jpg"}})])],1)]),n("div",{staticClass:"user-other-info"},[e.edit?n("div",{staticClass:"edit-user"},[n("i",{staticClass:"el-icon-success save-icon",staticStyle:{"margin-right":"5px"},on:{click:e.handleSaveUserInfo}}),n("i",{staticClass:"el-icon-error discard-icon",on:{click:e.handleDiscardUserInfo}})]):n("div",{staticClass:"edit-user",on:{click:e.handleEdit}},[n("i",{staticClass:"el-icon-edit edit-icon"})]),n("div",{staticClass:"user-info-item"},[n("div",{staticClass:"user-id"},[n("p",[e._v("用户id："+e._s(e.userInfo.userId))])])]),n("div",{staticClass:"user-info-item"},[n("div",{staticClass:"user-nick"},[e.edit?n("p",[e._v("\n          昵称："),n("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini"},model:{value:e.tmpUserInfo.nick,callback:function(t){e.$set(e.tmpUserInfo,"nick",t)},expression:"tmpUserInfo.nick"}})],1):n("p",[e._v("昵称："+e._s(e.userInfo.nick))])])]),n("div",{staticClass:"user-info-item"},[n("div",{staticClass:"user-sex"},[e.edit?n("p",[e._v("\n          性别：\n          "),n("el-select",{staticStyle:{width:"100px"},attrs:{size:"mini"},model:{value:e.tmpUserInfo.sex,callback:function(t){e.$set(e.tmpUserInfo,"sex",t)},expression:"tmpUserInfo.sex"}},e._l(e.sexOptions,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1):n("p",[e._v("性别："+e._s(e.userInfo.sex))])])]),n("div",{staticClass:"user-info-item"},[n("div",{staticClass:"user-age"},[e.edit?n("p",[e._v("\n          年龄："),n("el-input",{staticStyle:{width:"100px"},attrs:{size:"mini"},model:{value:e.tmpUserInfo.age,callback:function(t){e.$set(e.tmpUserInfo,"age",t)},expression:"tmpUserInfo.age"}})],1):n("p",[e._v("年龄："+e._s(e.userInfo.age))])])]),n("div",{staticClass:"user-info-item"},[n("div",{staticClass:"user-role"},[n("p",[e._v("角色："+e._s(e.userInfo.role))])])]),n("div",{staticClass:"user-info-item"},[n("div",{staticClass:"user-email"},[n("p",[e._v("邮箱："+e._s(e.userInfo.email))])])]),n("div",{staticClass:"user-info-item"},[n("div",{staticClass:"user-email-v"},[n("p",[e._v("邮箱已验证："+e._s(e.userInfo.emailVerified))])])]),n("div",{staticClass:"user-info-item"},[n("div",{staticClass:"user-phone"},[n("p",[e._v("手机号："+e._s(e.userInfo.phone))])])]),n("div",{staticClass:"user-info-item"},[n("div",{staticClass:"user-phone-v"},[n("p",[e._v("手机号已验证："+e._s(e.userInfo.phoneVerified))])])]),n("div",{staticClass:"user-info-item"},[n("div",{staticClass:"user-reg-time"},[n("p",[e._v("注册时间："+e._s(e.formateDate(e.userInfo.createTime)))])])]),n("div",{staticClass:"user-info-item"},[n("div",{staticClass:"user-modify-time"},[n("p",[e._v("修改时间："+e._s(e.formateDate(e.userInfo.modifyTime)))])])]),n("div",{staticClass:"user-info-item"},[n("div",{staticClass:"user-lock"},[n("p",[e._v("是否被锁定："+e._s(e.userInfo.isLock))])])]),n("div",{staticClass:"user-info-item"},[n("div",{staticClass:"user-lock-time"},[n("p",[e._v("锁定时长："+e._s(e.userInfo.lockTime))])])])])])},it=[],rt=function(e){var t=new Date(e),n=function(e){return e<10?"0"+e:e};return t.getFullYear()+"/"+n(t.getMonth()+1)+"/"+n(t.getDate())+" "+n(t.getHours())+":"+n(t.getMinutes())+":"+n(t.getSeconds())},ot={formateDate:rt},ct={name:"UserDetail",data:function(){return{userInfo:{},tmpUserInfo:{},edit:!1,sexOptions:[{value:"男",label:"男"},{value:"女",label:"女"},{value:"不明",label:"不明"}]}},methods:{getUserDetail:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.getUserByUid(t);case 2:n=e.sent,a=n.data,console.log("userDetail:",a),0===a.code?this.userInfo=a.data:this.$message({message:a.msg,type:"error"});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),formateDate:function(e){return ot.formateDate(e)},handleAvatarSuccess:function(e,t){console.log("handleAvatarSucc invoked!"),console.log(e),console.log(t);var n=e.data.link;n=n.substring(n.lastIndexOf("/")),console.log("link:",n),this.userInfo.face=this.GLOBAL.imgURL+n,console.log(this.userInfo.face)},beforeAvatarUpload:function(e){console.log("file ",e);var t=e.size/1024/1024<2;return t||this.$message.error("上传头像图片大小不能超过 2MB!"),t},handleEdit:function(){this.edit=!0,this.tmpUserInfo=JSON.parse(JSON.stringify(this.userInfo)),console.log("tmpUserInfo:",this.tmpUserInfo),console.log("edit user!")},handleSaveUserInfo:function(){this.userInfo=JSON.parse(JSON.stringify(this.tmpUserInfo)),console.log("userInfo:",this.userInfo),console.log("HandleSaveUserInfo..."),this.edit=!1},handleDiscardUserInfo:function(){this.edit=!1,console.log("handleDiscardUserInf...")}},created:function(){console.log("UserDetail.vue created!");var e=this.$route.params.uid;console.log("get uid from params:",e),e&&this.getUserDetail(e)}},lt=ct,ut=(n("gyWZ"),Object(Re["a"])(lt,st,it,!1,null,"dcbeed96",null)),dt=ut.exports,mt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"online-user"},[n("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadMore,expression:"loadMore"}],staticClass:"online-user-container",attrs:{"infinite-scroll-disabled":"busy","infinite-scroll-distance":"30"}},e._l(e.users,function(t){return n("div",{key:t.userId,staticClass:"ol-user-item"},[n("div",{staticClass:"user-face-wrap"},[n("img",{staticClass:"ol-user-face",attrs:{src:t.face?t.face:"/static/akari.jpg"}})]),n("div",{staticClass:"ol-user-info"},[n("div",{staticClass:"u-nick"},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.nick,placement:"top-start"}},[n("a",{attrs:{target:"_blank",href:"#/home/userdetail/"+t.userId}},[e._v("\n              "+e._s(t.nick.substring(0,6))+"\n            ")])])],1),n("div",{staticClass:"u-age"},[e._v(e._s(t.age))]),n("div",{staticClass:"u-sex"},[e._v(e._s(t.sex))])])])}))])},pt=[],gt=n("SHqN"),ht=n.n(gt),ft={name:"OnlineUserList",data:function(){return{users:[],page:{pageNumber:0},busy:!0,today:!1}},directives:{infiniteScroll:ht.a},methods:{initOnlineUsers:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.today){e.next=6;break}return e.next=3,we.getOnlineUsers(1,30,1);case 3:t=e.sent,e.next=9;break;case 6:return e.next=8,we.getOnlineUsers(1,30);case 8:t=e.sent;case 9:n=t.data,0===n.code&&(this.users=n.data.users,this.page=n.data.page);case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getOnlineUsers:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t,n){var a,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.getOnlineUsers(t,n);case 2:a=e.sent,s=a.data,0===s.code&&(this.users=s.data.users,this.page=s.data.page);case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),loadMore:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.busy=!0,setTimeout(Object(ke["a"])(regeneratorRuntime.mark(function e(){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!t.today){e.next=6;break}return e.next=3,we.getOnlineUsers(t.page.pageNumber+1,30,1);case 3:n=e.sent,e.next=9;break;case 6:return e.next=8,we.getOnlineUsers(t.page.pageNumber+1,30);case 8:n=n=e.sent;case 9:a=n.data,0===a.code?(a.data.users.length>0&&(t.users=t.users.concat(a.data.users),t.page=a.data.page,console.log("onlineusers:",t.users),console.log("page:",t.page)),console.log("loadMore get Data success")):console.log("loadMore失败");case 11:case"end":return e.stop()}},e,this)})),100),this.busy=!1;case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},created:function(){console.log("onlineUser.vue created");var e=this.$route.params.today;console.log("today:",e),e&&(this.today=!0),this.initOnlineUsers()}},vt=ft,bt=(n("T4ZT"),Object(Re["a"])(vt,mt,pt,!1,null,"147a28b8",null)),yt=bt.exports,wt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"bangumi-list"},[n("div",{staticClass:"filter-container"},[n("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"番剧名称"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.handleSearch(t):null}},model:{value:e.query.bangumiName,callback:function(t){e.$set(e.query,"bangumiName",t)},expression:"query.bangumiName"}}),n("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{circle:"",type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}}),n("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(t){e.showAddBangumiDialog=!0}}},[e._v("添加\n    ")]),n("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.handleDeleteInBatch}},[e._v("批量删除")]),n("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:e.getDefaultBangumis}},[e._v("显示所有番剧")])],1),n("el-table",{ref:"multipleTable",attrs:{height:"600",data:e.list,"element-loading-text":"loading...",border:"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"35"}}),n("el-table-column",{attrs:{label:"id",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("a",{attrs:{href:"#/home/bangumidetail/"+t.row.bangumiId}},[e._v(e._s(t.row.bangumiId))])]}}])}),n("el-table-column",{attrs:{label:"thumb",align:"center",width:"180"},scopedSlots:e._u([{key:"default",fn:function(e){return[n("img",{attrs:{width:"160px",height:"90px",src:e.row.thumb}})]}}])}),n("el-table-column",{attrs:{label:"番剧名",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("a",{attrs:{href:"#/home/bangumidetail/"+t.row.bangumiId}},[e._v(e._s(t.row.bangumiName))])]}}])}),n("el-table-column",{attrs:{label:"总集数",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("a",{attrs:{href:"#/home/bangumidetail/"+t.row.bangumiId}},[n("span",[e._v(e._s(t.row.episodeTotal))])])]}}])}),n("el-table-column",{attrs:{label:"播放数"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.viewCount))])]}}])}),n("el-table-column",{attrs:{label:"创建时间",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e.formateDate(t.row.createTime)))])]}}])}),n("el-table-column",{attrs:{label:"修改时间",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e.formateDate(t.row.modifyTime)))])]}}])}),n("el-table-column",{attrs:{fixed:"right",align:"center","min-width":"120",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(n){e.handleEdit(t.$index,t.row.bangumiId,t.row)}}}),n("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(n){e.handleDelete(t.$index,t.row)}}})]}}])})],1),e.listLoading?e._e():n("div",{staticClass:"pagination-container"},[n("el-pagination",{attrs:{"current-page":e.page.pageNumber,"page-sizes":[10,20,30,50],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.totalSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.page,"pageNumber",t)}}})],1),n("el-dialog",{attrs:{"before-close":e.clearTempBangumiInfo,title:"添加/修改番剧",visible:e.showAddBangumiDialog},on:{"update:visible":function(t){e.showAddBangumiDialog=t}}},[n("el-form",{staticClass:"small-space",staticStyle:{"margin-left":"50px"},attrs:{model:e.temp,"label-position":"left","label-width":"70px"}},[n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:""!=e.temp.bangumiId,expression:"temp.bangumiId!=''"}],attrs:{label:"id"}},[n("el-input",{model:{value:e.temp.bangumiId,callback:function(t){e.$set(e.temp,"bangumiId",t)},expression:"temp.bangumiId"}})],1),n("el-form-item",{attrs:{label:"番剧名称"}},[n("el-input",{model:{value:e.temp.bangumiName,callback:function(t){e.$set(e.temp,"bangumiName",t)},expression:"temp.bangumiName"}})],1),n("el-form-item",{attrs:{label:"总集数"}},[n("el-input",{model:{value:e.temp.episodeTotal,callback:function(t){e.$set(e.temp,"episodeTotal",t)},expression:"temp.episodeTotal"}})],1),n("el-form-item",{attrs:{label:"播放数"}},[n("el-input",{model:{value:e.temp.viewCount,callback:function(t){e.$set(e.temp,"viewCount",t)},expression:"temp.viewCount"}})],1),n("el-form-item",{attrs:{label:"图片"}},[n("div",{staticClass:"avatar-uploader"},[n("img",{directives:[{name:"show",rawName:"v-show",value:e.temp.thumb,expression:"temp.thumb"}],staticClass:"upload-img",attrs:{src:e.temp.thumb},on:{click:e.toggleShow}}),n("i",{directives:[{name:"show",rawName:"v-show",value:!e.temp.thumb,expression:"!temp.thumb"}],staticClass:"el-icon-plus avatar-uploader-icon",on:{click:e.toggleShow}}),n("my-upload",{attrs:{field:"image",width:960,height:540,noCircle:!0,url:e.GLOBAL.uploadURL,"img-format":"jpg",headers:e.GLOBAL.uploadHEADERS},on:{"crop-success":e.cropSuccess,"crop-upload-success":e.cropUploadSuccess,"crop-upload-fail":e.cropUploadFail},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}})],1)])],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.cancelAddBangumi}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.handleAddBangumi}},[e._v("确 定")])],1)],1)],1)},xt=[],_t=(n("201c"),n("C03Y")),kt={name:"bangumilist",data:function(){return{list:[],page:{},query:{bangumiName:"",lastQuery:""},showAddBangumiDialog:!1,temp:{bangumiId:"",bangumiName:"",thumb:"",episodeTotal:""},listLoading:!0,multiSelection:[],headers:{"Content-Type":"multipart/form-data"},show:!1}},components:{"my-upload":_t["a"]},mounted:function(){console.log("getDefaultBangumis!!!"),this.getDefaultBangumis()},methods:{handleSearch:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("search bangumiName:"+this.query.bangumiName),""!==this.query.bangumiName){e.next=4;break}return this.$message({showClose:!0,message:"请输入搜索内容",type:"info"}),e.abrupt("return");case 4:return e.next=6,we.searchBangumisByName(this.query.bangumiName,1,20);case 6:t=e.sent,n=t.data,0===n.code?(this.list=n.data.content,this.page=n.data.page,0===n.data.content.length&&this.$message({showClose:!0,message:"无搜索结果",type:"info"}),this.query.lastQuery=this.query.bangumiName):(this.list=[],this.page.totalSize=0,this.$message({showClose:!0,message:n.msg,type:"info"}));case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getDefaultBangumis:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.getBangumis(1,20);case 2:t=e.sent,n=t.data,console.log("getDefaultBangumis: "+t),console.log(n),0===n.code?(this.list=n.data.content,this.page=n.data.page,this.query.bangumiName="",this.query.lastQuery="",console.log(this.list),console.log(this.page)):this.$message({showClose:!0,message:t.data.msg,type:"error"}),this.listLoading=!1;case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),clearTempBangumiInfo:function(e){this.temp.bangumiName="",this.temp.episodeTotal="",this.temp.thumb="",this.temp.bangumiId="",console.log("clear temp..."),e()},handleEdit:function(e,t,n){console.log("edit bangumi!"),console.log("bangumi:",n),this.temp.bangumiName=n.bangumiName,this.temp.episodeTotal=n.episodeTotal,this.temp.thumb=n.thumb,this.temp.bangumiId=n.bangumiId,this.temp.viewCount=n.viewCount,console.log("edit index:",e),this.showAddBangumiDialog=!0},handleDelete:function(e,t){var n=this;console.log("delete bangumi"),console.log("index:",e),console.log(t),this.$confirm("删除番剧："+t.bangumiName,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",callback:function(){var a=Object(ke["a"])(regeneratorRuntime.mark(function a(s,i){var r;return regeneratorRuntime.wrap(function(a){while(1)switch(a.prev=a.next){case 0:if(console.log(i),"confirm"!==s){a.next=8;break}return a.next=4,we.deleteBangumi(t.bangumiId);case 4:r=a.sent,0===r.data.code?(console.log("删除成功，id:"+t.bangumiId),console.log("index:"+e),n.$message({showClose:!0,message:r.data.msg,type:"success"}),n.list.splice(e,1)):n.$message({showClose:!0,message:r.data.msg,type:"error"}),a.next=9;break;case 8:n.$message({showClose:!0,message:"已取消删除",type:"info"});case 9:case"end":return a.stop()}},a,this)}));return function(e,t){return a.apply(this,arguments)}}()})},handleDeleteInBatch:function(){var e=this;console.log("delInBatch!"),0!==this.multiSelection.length?this.$confirm("确定要删除多部番剧？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",callback:function(){var t=Object(ke["a"])(regeneratorRuntime.mark(function t(n,a){var s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(console.log(a),"confirm"!==n){t.next=8;break}return t.next=4,we.deleteBangumis(e.multiSelection);case 4:s=t.sent,0===s.data.code?(console.log("批量删除成功"),e.$message({showClose:!0,message:s.data.msg,type:"success"}),e.getDefaultBangumis(),e.multiSelection=[]):e.$message({showClose:!0,message:s.data.msg,type:"error"}),t.next=13;break;case 8:e.temp.bangumiName="",e.temp.episodeTotal="",e.temp.thumb="",e.temp.bangumiId="",e.$message({showClose:!0,message:"已取消删除",type:"info"});case 13:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()}):this.$message({showClose:!0,message:"未选中番剧",type:"info"})},handleAddBangumi:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("handle add bangumi!"),console.log("temp:",this.temp),""!==this.temp.bangumiId){e.next=9;break}return console.log("add bangumi..."),e.next=6,we.addBangumi(this.temp);case 6:t=e.sent,e.next=13;break;case 9:return console.log("edit bangumi..."),e.next=12,we.editBangumi(this.temp.bangumiId,this.temp);case 12:t=e.sent;case 13:n=t.data,console.log("addBangumi res:",n),0===n.code?(console.log("add succeeded!"),this.$message({showClose:!0,message:"操作成功",type:"success"}),this.showAddBangumiDialog=!1,this.temp.bangumiName="",this.temp.episodeTotal="",this.temp.thumb="",this.temp.bangumiId="",this.getDefaultBangumis()):this.$message({showClose:!0,message:n.msg,type:"error"});case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),handleSelectionChange:function(e){console.log("multi sel:",e),this.multiSelection=e},getPrettyTime:function(e){return e},formateDate:function(e){return ot.formateDate(e)},toggleShow:function(){this.show=!this.show},cropSuccess:function(e,t){console.log("-------- crop success --------")},cropUploadSuccess:function(e,t){console.log("-------- upload success --------"),console.log(e);var n=e.data.link;n=n.substring(n.lastIndexOf("/")),console.log("link:",n),this.temp.thumb=this.GLOBAL.imgURL+n,console.log(this.temp.thumb)},cropUploadFail:function(e,t){console.log("-------- upload fail --------"),console.log(e),console.log("field: "+t)},cancelAddBangumi:function(){this.showAddBangumiDialog=!1,this.temp.bangumiName="",this.temp.thumb="",this.temp.episodeTotal="",this.temp.bangumiId="",this.temp.viewCount=""},handleSizeChange:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("每页"+t+"条"),""===this.query.lastQuery){e.next=8;break}return console.log("last query:",this.query.lastQuery),e.next=5,we.searchBangumisByName(this.query.lastQuery,1,t);case 5:n=e.sent,e.next=12;break;case 8:return console.log("no lastQuery"),e.next=11,we.getBangumis(1,t);case 11:n=e.sent;case 12:a=n.data,console.log(a),0===a.code?(this.list=a.data.content,this.page=a.data.page):this.$message({showClose:!0,message:a.msg,type:"error"});case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),handleCurrentChange:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("curpage:"+t),""===this.query.lastQuery){e.next=8;break}return console.log("lastQuery:",this.query.lastQuery),e.next=5,we.searchBangumisByName(this.query.lastQuery,t,this.page.pageSize);case 5:n=e.sent,e.next=12;break;case 8:return console.log("lastQuery is empty"),e.next=11,we.getBangumis(t,this.page.pageSize);case 11:n=e.sent;case 12:a=n.data,console.log(a),0===a.code?(this.list=a.data.content,this.page=a.data.page):this.$message({showClose:!0,message:a.msg,type:"error"});case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),toEpisode:function(e){this.$router.push({name:"episodeList",params:{bid:e}})}}},Ct=kt,It=(n("SQog"),Object(Re["a"])(Ct,wt,xt,!1,null,"4da23fe8",null)),Rt=It.exports,St=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"bangumi-detail"},[n("h1",[e._v("番剧详情")]),n("div",{staticClass:"bangumi-info"},[n("div",{staticClass:"bangumi-img-wrapper"},[n("img",{staticClass:"bangumi-img",attrs:{src:e.bangumiInfo.thumb}})]),n("div",{staticClass:"bangumi-other"},[n("div",{staticClass:"b-item"},[n("p",[e._v("bangumiId："+e._s(e.bangumiInfo.bangumiId))])]),n("div",{staticClass:"b-item"},[n("p",[e._v("名称："+e._s(e.bangumiInfo.bangumiName))])]),n("div",{staticClass:"b-item"},[n("p",[e._v("总集数："+e._s(e.bangumiInfo.episodeTotal))])]),n("div",[n("p",[e._v("播放数："+e._s(e.bangumiInfo.viewCount))])]),n("div",{staticClass:"b-item"},[n("p",[e._v("创建时间："+e._s(e.formateDate(e.bangumiInfo.createTime)))])]),n("div",{staticClass:"b-item"},[n("p",[e._v("修改时间: "+e._s(e.formateDate(e.bangumiInfo.modifyTime)))])])])]),n("div",{staticClass:"episodes-container"},[e._l(e.episodes,function(t){return n("div",{key:t.epId,staticClass:"episodes"},[n("div",{staticClass:"episode"},[n("el-button",{attrs:{size:"mini"},on:{click:function(n){e.handleClickEpIndex(t)}}},[e._v(e._s(t.epIndex))])],1)])}),n("div",{directives:[{name:"show",rawName:"v-show",value:e.page.totalSize&&e.page.totalSize>10,expression:"page.totalSize && page.totalSize >10"}],staticClass:"page-info"},[e.loading?e._e():n("div",{staticClass:"pagination-container"},[n("el-pagination",{attrs:{"current-page":e.page.pageNumber,"page-sizes":[10,20,30,50],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.totalSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.page,"pageNumber",t)}}})],1)]),e.curEpisodeInfo?n("div",{staticClass:"episode-detail-wrapper"},[n("div",{staticClass:"simple-ep-info"},[n("p",[n("span",[e._v("第"+e._s(e.curEpisodeInfo.epIndex)+"集")]),n("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(t){e.clickEditEpisode(e.curEpisodeInfo)}}}),n("i",{staticClass:"el-icon-delete del-ep-icon",on:{click:function(t){e.delEpisode(e.curEpisodeInfo.epId)}}})],1),n("p",[e._v("danmakuId: "+e._s(e.curEpisodeInfo.danmakuId))]),n("p",[e._v("url: "+e._s(e.curEpisodeInfo.url))]),n("p",[e._v(e._s(1===e.curEpisodeInfo.replyable?"可评论":"禁止评论"))]),n("p",[e._v("创建："+e._s(e.formateDate(e.curEpisodeInfo.createTime)))]),n("p",[e._v("修改："+e._s(e.formateDate(e.curEpisodeInfo.modifyTime)))]),n("p",[e._v("评论数："+e._s(e.episodeComm))]),n("p",[e._v("播放数："+e._s(e.curEpisodeInfo.viewCount))]),n("p",[e._v("关联视频数："+e._s(e.videos.length))])]),n("div",{staticClass:"related-videos"},e._l(e.videos,function(t){return n("div",{key:t.videoId,staticClass:"r-video"},[n("div",{staticClass:"v-operation",on:{click:function(n){e.handelDelVideo(t.videoId)}}},[n("i",{staticClass:"el-icon-delete v-del-icon"})]),n("p",[e._v("videoId:\n            "),n("span",[e._v(e._s(t.videoId))])]),n("p",[e._v("vMD5:\n            "),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.vMd5,placement:"top"}},[n("span",[e._v(e._s(t.vMd5.substring(0,6)))])])],1),n("p",[e._v("大小："+e._s((t.fileSize/1024/1024).toFixed(2))+"MB")]),n("p",[e._v(e._s(e.formateDate(t.createTime)))]),n("p",[e._v(e._s(1===t.isMatch?"已验证":"未验证"))])])}))]):e._e()],2),n("el-dialog",{attrs:{title:"修改第"+e.curEpisodeInfo.epIndex+"集",visible:e.showEditEpisodeBox},on:{"update:visible":function(t){e.showEditEpisodeBox=t}}},[n("el-form",{staticClass:"small-space",staticStyle:{"margin-left":"50px"},attrs:{model:e.tempEpisode,"label-position":"left","label-width":"70px"}},[n("el-form-item",{attrs:{label:"弹幕id"}},[n("el-input",{model:{value:e.tempEpisode.danmakuId,callback:function(t){e.$set(e.tempEpisode,"danmakuId",t)},expression:"tempEpisode.danmakuId"}})],1),n("el-form-item",{attrs:{label:"可回复"}},[n("el-switch",{attrs:{"active-color":"#3a86ef","inactive-color":"#777"},model:{value:e.tempEpisode.replyable,callback:function(t){e.$set(e.tempEpisode,"replyable",t)},expression:"tempEpisode.replyable"}})],1),n("el-form-item",{attrs:{label:"URL"}},[n("el-input",{model:{value:e.tempEpisode.url,callback:function(t){e.$set(e.tempEpisode,"url",t)},expression:"tempEpisode.url"}})],1),n("el-form-item",{attrs:{label:"播放数"}},[n("el-input",{model:{value:e.tempEpisode.viewCount,callback:function(t){e.$set(e.tempEpisode,"viewCount",t)},expression:"tempEpisode.viewCount"}})],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.cancelEditEpisode}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.handleEditEpisode}},[e._v("确 定")])],1)],1)],1)},Bt=[],Et={name:"BangumiDetail",data:function(){return{bid:"",bangumiInfo:"",episodes:"",page:"",videos:"",episodeComm:0,curEpisodeInfo:"",loading:!0,showEditEpisodeBox:!1,tempEpisode:{danmakuId:"",epIndex:"",replyable:"",url:"",viewCount:""}}},methods:{updateBangumiInfo:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t,n){var a,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.editBangumi(t,n);case 2:a=e.sent,s=a.data,s.code;case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),getEpisodesByBangumiId:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.getEpisodesByBangumiId(t,1,20);case 2:n=e.sent,a=n.data,console.log("getEpisodesByBangumiId:",a),0===a.code&&(this.episodes=a.data.episodes,this.page=a.data.page,this.loading=!1);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),getBangumiById:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.getBangumiById(t);case 2:n=e.sent,a=n.data,console.log("getBangumiById:",a),0===a.code&&(this.bangumiInfo=a.data);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),getVideosByEid:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.getRelatedVideosByEpisodeId(t,1,20);case 2:n=e.sent,a=n.data,console.log("getVideosByEid:",a),0===a.code?this.videos=a.data.videos:console.log("err getting Videos...");case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),getNumOfCommentsByEid:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.getReplies(t,1);case 2:n=e.sent,a=n.data,0===a.code?(this.episodeComm=a.data.page.totalSize,console.log("episodeComm:",this.episodeComm)):console.log("err getting episodeComm...");case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),handleClickEpIndex:function(e){this.curEpisodeInfo=e,console.log("curEpisodeInfo:",this.curEpisodeInfo),this.getVideosByEid(e.epId),this.getNumOfCommentsByEid(e.epId),console.log("handle click epIndex!")},clickEditEpisode:function(e){this.tempEpisode.url=e.url,this.tempEpisode.replyable=!!e.replyable,this.tempEpisode.danmakuId=e.danmakuId,this.tempEpisode.viewCount=e.viewCount,this.showEditEpisodeBox=!0},cancelEditEpisode:function(){this.tempEpisode.url="",this.tempEpisode.replyable="",this.tempEpisode.danmakuId="",this.tempEpisode.viewCount="",this.showEditEpisodeBox=!1},handleEditEpisode:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.editEpisode(this.curEpisodeInfo.epId,{url:this.tempEpisode.url,replyable:this.tempEpisode.replyable?1:0,danmakuId:this.tempEpisode.danmakuId,viewCount:this.tempEpisode.viewCount});case 2:t=e.sent,n=t.data,0===n.code?(this.$message({message:"修改成功",type:"success"}),this.curEpisodeInfo.url=this.tempEpisode.url,this.curEpisodeInfo.replyable=this.tempEpisode.replyable,this.curEpisodeInfo.danmakuId=this.tempEpisode.danmakuId,this.curEpisodeInfo.viewCount=this.tempEpisode.viewCount,this.getEpisodesByBangumiId(this.bid)):this.$message({message:n.msg,type:"error"}),this.tempEpisode.url="",this.tempEpisode.replyable="",this.tempEpisode.danmakuId="",this.tempEpisode.viewCount="",this.showEditEpisodeBox=!1;case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),handelDelVideo:function(e){var t=this;console.log("del video:",e),this.$confirm("确定要删除该视频？","提示",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning",callback:function(){var n=Object(ke["a"])(regeneratorRuntime.mark(function n(a){var s,i;return regeneratorRuntime.wrap(function(n){while(1)switch(n.prev=n.next){case 0:if("confirm"!==a){n.next=7;break}return n.next=3,we.deleteVideo(e);case 3:s=n.sent,i=s.data,console.log("delete video result:",i),0===i.code?(t.videos=t.videos.filter(function(t){return t.videoId!=e}),t.$message({showClose:!0,message:"已删除",type:"success"})):t.$message({showClose:!0,message:i.msg,type:"error"});case 7:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}()})},formateDate:function(e){return ot.formateDate(e)},handleSizeChange:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return console.log("每页"+t+"条"),e.next=3,we.getEpisodesByBangumiId(this.bangumiInfo.bangumiId,1,t);case 3:n=e.sent,a=n.data,console.log(a),0===a.code?(this.episodes=a.data.episodes,this.page=a.data.page):this.$message({showClose:!0,message:a.msg,type:"error"});case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),handleCurrentChange:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return console.log("curpage:"+t),e.next=3,we.getEpisodesByBangumiId(this.bangumiInfo.bangumiId,t,this.page.pageSize);case 3:n=e.sent,a=n.data,console.log(a),0===a.code?(this.episodes=a.data.episodes,this.page=a.data.page):this.$message({showClose:!0,message:a.msg,type:"error"});case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),delEpisode:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:console.log("delEpisode:",t),this.$confirm("确定要删除该集？","提示",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning",callback:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(a){var s,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if("confirm"!==a){e.next=6;break}return e.next=3,we.deleteEpisode(t);case 3:s=e.sent,i=s.data,0===i.code?(n.curEpisodeInfo="",n.videos="",n.episodes=n.episodes.filter(function(e){return e.epId!=t}),n.$message({showClose:!0,message:"已删除",type:"success"})):n.$message({showClose:!0,message:i.msg,type:"error"});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},created:function(){var e=this.$route.params.bid;console.log("bid:",e),e?(this.bid=e,this.getBangumiById(e),this.getEpisodesByBangumiId(e)):console.log("未获取到bangumiId")}},Tt=Et,Ot=(n("sbKH"),Object(Re["a"])(Tt,St,Bt,!1,null,"43746b1c",null)),$t=Ot.exports,Ut=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"bangumi-edit"},[n("div",{staticClass:"be-form"},[n("el-form",{staticClass:"small-space",attrs:{model:e.temp,"label-position":"left","label-width":"70px"}},[n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:""!=e.temp.bangumiId,expression:"temp.bangumiId!=''"}],attrs:{label:"id"}},[n("el-input",{model:{value:e.temp.bangumiId,callback:function(t){e.$set(e.temp,"bangumiId",t)},expression:"temp.bangumiId"}})],1),n("el-form-item",{attrs:{label:"番剧名称"}},[n("el-input",{model:{value:e.temp.bangumiName,callback:function(t){e.$set(e.temp,"bangumiName",t)},expression:"temp.bangumiName"}})],1),n("el-form-item",{attrs:{label:"总集数"}},[n("el-input",{model:{value:e.temp.episodeTotal,callback:function(t){e.$set(e.temp,"episodeTotal",t)},expression:"temp.episodeTotal"}})],1),n("el-form-item",{attrs:{label:"图片"}},[n("div",{staticClass:"upload-container"},[e.imageUrl?n("img",{staticClass:"upload-img",attrs:{src:e.imageUrl},on:{click:e.toggleShow}}):n("i",{staticClass:"el-icon-plus avatar-uploader-icon",on:{click:e.toggleShow}}),n("my-upload",{attrs:{field:"image",width:960,height:540,noCircle:!0,url:e.GLOBAL.uploadURL,headers:e.GLOBAL.uploadHEADERS,"img-format":"jpg"},on:{"crop-success":e.cropSuccess,"crop-upload-success":e.cropUploadSuccess,"crop-upload-fail":e.cropUploadFail},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}})],1)])],1),n("el-button",{attrs:{type:"primary"},on:{click:e.handleAddBangumi}},[e._v("添加")])],1),n("div")])},jt=[],Nt={name:"BangumiEdit",data:function(){return{temp:{bangumiId:"",bangumiName:"",thumb:"",episodeTotal:""},imageUrl:"",show:!1}},components:{"my-upload":_t["a"]},methods:{toggleShow:function(){this.show=!this.show},cropSuccess:function(e,t){console.log("-------- crop success --------")},cropUploadSuccess:function(e,t){console.log("-------- upload success --------"),console.log(e);var n=e.data.link;n=n.substring(n.lastIndexOf("/")),console.log("link:",n),this.temp.thumb=this.GLOBAL.imgURL+n,this.imageUrl=this.GLOBAL.imgURL+n},cropUploadFail:function(e,t){console.log("-------- upload fail --------"),console.log(e),console.log("field: "+t)},handleAddBangumi:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("handle add bangumi!"),console.log("temp:",this.temp),""!==this.temp.bangumiId){e.next=9;break}return console.log("add bangumi..."),e.next=6,we.addBangumi(this.temp);case 6:t=e.sent,e.next=13;break;case 9:return console.log("edit bangumi..."),e.next=12,we.editBangumi(this.temp.bangumiId,this.temp);case 12:t=e.sent;case 13:n=t.data,console.log("addBangumi res:",n),0===n.code?(console.log("add succeeded!"),this.$message({showClose:!0,message:"操作成功",type:"success"}),this.temp.bangumiName="",this.temp.episodeTotal="",this.temp.thumb="",this.temp.bangumiId="",this.imageUrl=""):this.$message({showClose:!0,message:n.msg,type:"error"});case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}},Dt=Nt,Lt=(n("7rLg"),Object(Re["a"])(Dt,Ut,jt,!1,null,"3714b880",null)),At=Lt.exports,zt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-post-bangumi"},[n("div",{staticClass:"filter-container"},[n("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"用户名"}}),n("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{circle:"",type:"primary",icon:"el-icon-search"}}),n("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:e.showAll}},[e._v("显示全部")]),n("div",{staticStyle:{display:"inline-block",float:"right"}},[n("el-dropdown",{on:{command:e.handleCommand}},[n("span",{staticClass:"el-dropdown-link"},[e._v("标签\n          "),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.pbOptions,function(t){return n("el-dropdown-item",{key:t.label,attrs:{command:t.value}},[e._v("\n            "+e._s(t.label)+"\n          ")])}))],1)],1)],1),n("div",{staticClass:"cards"},e._l(e.bangumis,function(t){return n("div",{key:t.id,staticClass:"card-wrapper"},[n("my-card",{attrs:{bangumi:t},on:{updatePostBangumiCard:e.updatePostBangumiCard}})],1)})),e.loading?e._e():n("div",{staticClass:"pagination-container"},[n("el-pagination",{attrs:{"current-page":e.page.pageNumber,"page-sizes":[10,20,30,50],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.totalSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.page,"pageNumber",t)}}})],1)])},Pt=[],Mt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"upb-card"},[n("div",{staticClass:"box-card"},[n("div",{staticClass:"card-header clearfix"},[n("span",{staticStyle:{display:"inline-block",padding:"3px 5px",color:"#d2cece"}},[e._v(e._s(e.bangumi.bn))]),n("span",{staticClass:"pb-status",class:{pending:e.isPending,failed:e.isFailed,success:e.isSuccess,nperfect:e.isNotPerfect,auditting:e.isAuditting}},[e._v("\n        "+e._s(e.bangumi.pbs_name)+"\n      ")])]),n("div",{staticClass:"card-body"},[n("div",{staticClass:"bangumi-info"},[n("div",{staticClass:"thumb-wrapper"},[n("img",{staticClass:"thumb",attrs:{src:e.bangumi.thumb}})]),n("div",{staticClass:"bangumi-info-item"},[n("p",[e._v("提交日期:"),n("br"),e._v(e._s(e.formateDate(e.bangumi.create_time)))]),n("p",[e._v("修改日期:"),n("br"),e._v(e._s(e.formateDate(e.bangumi.modify_time)))]),n("p",{staticClass:"item-left"},[e._v("共"+e._s(e.bangumi.et)+"集")]),n("p",{staticClass:"item-left"},[e._v(e._s(1===e.bangumi.hzi?"有第0集":"无第0集"))]),e.bangumi.manager_user?n("p",{staticClass:"item-left"},[e._v("审核:\n            "),n("el-popover",{attrs:{placement:"top-start",trigger:"hover"}},[n("div",{staticClass:"manager-info"},[n("div",{staticClass:"manager-avatar-wrapper"},[n("img",{staticClass:"manager-avatar-img",attrs:{src:e.bangumi.manager_user.face}})]),n("div",{staticClass:"manager-nick"},[n("span",{staticClass:"manager-nick-link"},[n("a",{attrs:{target:"_blank",href:"#/home/userdetail/"+e.bangumi.manager_user.uid}},[e._v("\n                      "+e._s(e.bangumi.manager_user.nick)+"\n                    ")])])])]),n("span",{staticClass:"manager-nick-link",attrs:{slot:"reference"},slot:"reference"},[n("a",{attrs:{target:"_blank",href:"#/home/userdetail/"+e.bangumi.manager_user.uid}},[e._v("\n                  "+e._s(e.bangumi.manager_user.nick)+"\n                ")])])])],1):e._e(),e.bangumi.msg?n("p",{staticClass:"item-right-bottom"},[e._v("修改意见:"),n("br"),n("el-tooltip",{attrs:{placement:"top"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.bangumi.msg))]),n("span",[e._v(e._s(e.getMsg))])])],1):e._e()])])]),n("div",{staticClass:"card-footer"},[n("div",{staticClass:"post-user"},[n("div",{staticClass:"avatar-wrapper"},[n("img",{staticClass:"avatar-img",attrs:{src:e.bangumi.post_user.face}})]),n("div",{staticClass:"user-nick"},[n("a",{attrs:{target:"_blank",href:"#/home/userdetail/"+e.bangumi.post_user.uid}},[n("span",{staticStyle:{color:"#a5a5a5"}},[e._v("\n              "+e._s(e.bangumi.post_user.nick)+"\n            ")])])])]),n("div",{staticClass:"operation"},[n("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-check",circle:""},on:{click:e.approveUPB}}),n("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete",circle:""},on:{click:e.declineUPB}})],1)])])])},qt=[],Vt={props:["bangumi"],data:function(){return{validBangumiInfo:{bangumiId:"",bangumiName:"",thumb:"",episodeTotal:""},amendMsg:""}},computed:{isPending:function(){return"待处理"===this.bangumi.pbs_name},isSuccess:function(){return"已采纳"===this.bangumi.pbs_name},isNotPerfect:function(){return"待完善"===this.bangumi.pbs_name},isFailed:function(){return"未被采纳"===this.bangumi.pbs_name},isAuditting:function(){return"待审核"===this.bangumi.pbs_name},getMsg:function(){return this.bangumi.msg&&this.bangumi.msg.length>10?(console.log("substring:",this.bangumi.msg.substring(0,10)),this.bangumi.msg.substring(0,10)+"..."):this.bangumi.msg}},methods:{formateDate:function(e){return ot.formateDate(e)},approveUPB:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:console.log("approve adding bangumi"),this.validBangumiInfo.bangumiName=this.bangumi.bn,this.validBangumiInfo.thumb=this.bangumi.thumb,this.validBangumiInfo.episodeTotal=this.bangumi.et,console.log("validBangumiInfo:",this.validBangumiInfo),this.$confirm("确认番剧信息无误？","提示",{confirmButtonText:"OK",cancelButtonText:"不行",type:"warning",callback:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(n){var a,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if("confirm"!==n){e.next=8;break}return console.log("postBangumi id:",t.bangumi.id),e.next=4,we.acceptUserPostBangumi(t.bangumi.id);case 4:a=e.sent,s=a.data,console.log("accept rd:",s),0===s.code?(t.bangumi.pbs_name="已采纳",t.$emit("updatePostBangumiCard",s.data.id),t.$message({showClose:!0,message:"已添加对应番剧信息",type:"success"})):t.$message({showClose:!0,message:s.msg,type:"error"});case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),declineUPB:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:console.log("decline adding bangumi"),this.$prompt("错误信息提示：","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",callback:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(n,a){var s,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if("confirm"!==n){e.next=8;break}return console.log("错误信息提示："+a.inputValue),e.next=4,we.declineUserPostBangumi(t.bangumi.id,2,a.inputValue);case 4:s=e.sent,i=s.data,console.log("decline rd:",i),0===i.code?(t.bangumi.pbs_name="待完善",t.$emit("updatePostBangumiCard",i.data.id),t.$message({showClose:!0,message:"已反馈错误信息",type:"success"})):t.$message({showClose:!0,message:i.msg,type:"error"});case 8:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()});case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),handleAvatarSuccess:function(e,t){console.log("handleAvatarSucc invoked!"),console.log(e),console.log(t);var n=e.data.link;n=n.substring(n.lastIndexOf("/")),console.log("link:",n),this.bangumi.thumb=this.GLOBAL.imgURL+n,console.log(this.bangumi.thumb)},beforeAvatarUpload:function(e){console.log("file ",e);var t=e.size/1024/1024<2;return t||this.$message.error("上传头像图片大小不能超过 2MB!"),t}}},Ft=Vt,Ht=(n("HNtT"),Object(Re["a"])(Ft,Mt,qt,!1,null,"355b47e8",null)),Gt=Ht.exports,Qt={name:"UserPostBangumi",data:function(){return{bangumis:[],page:"",loading:!0,pbOptions:[{value:"0",label:"全部"},{value:"1",label:"待处理"},{value:"2",label:"已采纳"},{value:"3",label:"待完善"},{value:"4",label:"未被采纳"},{value:"5",label:"待审核"}],pbParams:{pn:1,ps:10,sc:"",pbsc:"",pc:"",dc:"",bn:""}}},components:{"my-card":Gt},methods:{initUserPostBangumis:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.getUserPostBangumis(1,10);case 2:t=e.sent,n=t.data,0===n.code?(this.bangumis=n.data.postBangumi,this.page=n.data.page,this.loading=!1):this.$message({showClose:!0,message:n.msg,type:"error"});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),handleSizeChange:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return console.log("每页"+t+"条"),this.pbParams.pn=1,this.pbParams.ps=t,e.next=5,we.getUserPostBangumisByParams(this.pbParams);case 5:n=e.sent,a=n.data,0===a.code?(this.bangumis=a.data.postBangumi,this.page=a.data.page):this.$message({showClose:!0,message:a.msg,type:"error"});case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),handleCurrentChange:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return console.log("curpage:"+t),this.pbParams.pn=t,this.pbParams.ps=this.page.pageSize,e.next=5,we.getUserPostBangumisByParams(this.pbParams);case 5:n=e.sent,a=n.data,console.log(a),0===a.code?(this.bangumis=a.data.postBangumi,this.page=a.data.page):this.$message({showClose:!0,message:a.msg,type:"error"});case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),formateDate:function(e){return ot.formateDate(e)},updatePostBangumiCard:function(e){var t=this;console.log("updateUserPostBCard,id:",e),setTimeout(function(){console.log("delay 3s"),t.bangumis=t.bangumis.filter(function(t){return t.id!=e})},3e3)},showAll:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.getUserPostBangumis(1,10);case 2:t=e.sent,n=t.data,0===n.code?(this.bangumis=n.data.postBangumi,this.page=n.data.page):this.$message({showClose:!0,message:n.msg,type:"error"});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),handleCommand:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return console.log("command:",t),this.pbParams.pbsc="0"===t?"":t,this.pbParams.pn=1,e.next=5,we.getUserPostBangumisByParams(this.pbParams);case 5:n=e.sent,a=n.data,0===a.code?(this.bangumis=a.data.postBangumi,this.page=a.data.page,this.loading=!1):console.log("get userPostBangumi err");case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},created:function(){console.log("UserPostBangumi.vue created!!!"),this.initUserPostBangumis()}},Jt=Qt,Zt=(n("Yp8L"),Object(Re["a"])(Jt,zt,Pt,!1,null,"70eeab89",null)),Wt=Zt.exports,Kt=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},Xt=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"episode-list"},[n("h1",[e._v("剧集列表")])])}],Yt={name:"EpisodeList"},en=Yt,tn=(n("4u1O"),Object(Re["a"])(en,Kt,Xt,!1,null,"5bdcfdae",null)),nn=tn.exports,an=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},sn=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"episode-detail"},[n("h1",[e._v("剧集详情")])])}],rn={name:"EpisodeDetail"},on=rn,cn=(n("A0R8"),Object(Re["a"])(on,an,sn,!1,null,"a89b33f0",null)),ln=cn.exports,un=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},dn=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"video-list"},[n("h1",[e._v("视频列表")])])}],mn={name:"VideoList"},pn=mn,gn=(n("z4It"),Object(Re["a"])(pn,un,dn,!1,null,"b67b1146",null)),hn=gn.exports,fn=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},vn=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"video-detail"},[n("h1",[e._v("视频详情")])])}],bn={name:"VideoDetail"},yn=bn,wn=(n("+Rab"),Object(Re["a"])(yn,fn,vn,!1,null,"bd86b708",null)),xn=wn.exports,_n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-post-video"},[n("h1",[e._v("用户提交的视频信息列表")]),n("div",{staticClass:"videos"},[n("div",{staticClass:"filter-container"},[n("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"}}),n("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{circle:"",type:"primary",icon:"el-icon-search"}}),n("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-delete"}},[e._v("批量删除")]),n("el-button",{staticClass:"filter-item",attrs:{type:"primary"}},[e._v("显示全部")])],1),n("el-table",{ref:"video-tb",attrs:{height:"600",data:e.videos,border:"","highlight-current-row":""}},[n("el-table-column",{attrs:{type:"selection",width:"35"}}),n("el-table-column",{attrs:{label:"id",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.videoId)+"\n        ")]}}])}),n("el-table-column",{attrs:{label:"md5",align:"center",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.vMd5)+"\n        ")]}}])}),n("el-table-column",{attrs:{label:"文件大小（MB）",align:"center",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("p",[e._v(e._s((t.row.fileSize/1024/1024).toFixed(2)))])]}}])}),n("el-table-column",{attrs:{label:"提交时间",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e.formateDate(t.row.createTime)))])]}}])}),n("el-table-column",{attrs:{label:"修改时间",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e.formateDate(t.row.modifyTime)))])]}}])}),n("el-table-column",{attrs:{label:"score",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.score))])]}}])}),n("el-table-column",{attrs:{fixed:"right",align:"center","min-width":"120",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"primary",icon:"el-icon-check",circle:""},on:{click:function(n){e.acceptVideo(t.row)}}}),n("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(n){e.deleteVideo(t.row.videoId)}}})]}}])})],1),e.loading?e._e():n("div",{staticClass:"pagination-container"},[n("el-pagination",{attrs:{"current-page":e.page.pageNumber,"page-sizes":[10,20,30,50],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.totalSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.page,"pageNumber",t)}}})],1)],1)])},kn=[],Cn={name:"UserPostVideo",data:function(){return{videos:[],page:"",loading:!0}},methods:{initVideos:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.getVideos(0,1,20);case 2:t=e.sent,n=t.data,0===n.code?(this.videos=n.data.videos,this.page=n.data.pageInfo,this.loading=!1):this.$message({showClose:!0,message:n.msg,type:"error"});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),handleSizeChange:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return console.log("每页"+t+"条"),e.next=3,we.getVideos(0,1,t);case 3:n=e.sent,a=n.data,0===a.code?(this.videos=a.data.videos,this.page=a.data.pageInfo):this.$message({showClose:!0,message:a.msg,type:"error"});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),handleCurrentChange:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return console.log("curpage:"+t),e.next=3,we.getVideos(0,t,this.page.pageSize);case 3:n=e.sent,a=n.data,console.log(a),0===a.code?(this.videos=a.data.videos,this.page=a.data.pageInfo):this.$message({showClose:!0,message:a.msg,type:"error"});case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),acceptVideo:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t.isMatch=1,this.$confirm("添加该视频匹配信息？","提示",{confirmButtonText:"OK",cancelButtonText:"不行",type:"warning",callback:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(a){var s,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if("confirm"!==a){e.next=6;break}return e.next=3,we.editVideo(t.videoId,t);case 3:s=e.sent,i=s.data,0===i.code?(n.$message({showClose:!0,message:"已添加对应视频匹配信息",type:"success"}),n.intervalId=setTimeout(function(){n.videos=n.videos.filter(function(e){return e.videoId!=t.videoId})},2e3)):n.$message({showClose:!0,message:i.msg,type:"error"});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),deleteVideo:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.$confirm("删除该视频匹配信息？","提示",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning",callback:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(a){var s,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if("confirm"!==a){e.next=7;break}return console.log("vid:",t),e.next=4,we.deleteVideo(t);case 4:s=e.sent,i=s.data,0===i.code?(n.$message({showClose:!0,message:"已删除对应视频匹配信息",type:"success"}),n.videos=n.videos.filter(function(e){return e.videoId!=t})):n.$message({showClose:!0,message:i.msg,type:"error"});case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()});case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),formateDate:function(e){var t=new Date(e);return t.getFullYear()+"/"+this.fillZero(t.getMonth()+1)+"/"+this.fillZero(t.getDate())+" "+this.fillZero(t.getHours())+":"+this.fillZero(t.getMinutes())+":"+this.fillZero(t.getSeconds())},fillZero:function(e){return e<10?"0"+e:e}},created:function(){console.log("UserPostVIdeo.vue created!!!"),this.initVideos()}},In=Cn,Rn=(n("kZym"),Object(Re["a"])(In,_n,kn,!1,null,"465be8ba",null)),Sn=Rn.exports,Bn=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},En=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"danmaku-list"},[n("h1",[e._v("弹幕列表")])])}],Tn={name:"DanmakuList"},On=Tn,$n=(n("9/oT"),Object(Re["a"])(On,Bn,En,!1,null,"1234bdf4",null)),Un=$n.exports,jn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"report-container"},[n("div",[n("el-button",{attrs:{type:"primary"},on:{click:e.initReport}},[e._v("\n      刷新\n    ")])],1),n("div",e._l(e.reports,function(t,a){return n("div",{key:t.id,staticClass:"report-entity"},[n("div",{staticClass:"rp-operation"},[n("el-button",{attrs:{type:"primary"},on:{click:function(n){e.clickApprove(t.id,a)}}},[e._v("\n          采纳\n        ")]),n("el-button",{attrs:{type:""},on:{click:function(n){e.clickDeny(t.id,a)}}},[e._v("\n          否决\n        ")])],1),n("p",[e._v("handledTime:"+e._s(t.handledTime))]),n("p",[e._v("createTime:"+e._s(new Date(t.createTime).toDateString()))]),n("p",[e._v("handleStatus:"+e._s(t.handleStatus))]),n("p",[e._v("publisherUserId:"+e._s(t.publisherUserId))]),n("p",[e._v("targetType:"+e._s(t.targetType))]),n("p",[e._v("managerId:"+e._s(t.managerId))]),n("p",[e._v("id: "+e._s(t.id))]),n("p",[e._v("content: "+e._s(t.content))]),n("p",[e._v("reportReason: "+e._s(t.reportReason))])])})),e.page?n("div",{staticClass:"pagination"},[n("el-pagination",{attrs:{"current-page":e.page.pageNumber,layout:"total, prev, pager, next, jumper",total:e.page.totalSize},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.page,"pageNumber",t)}}})],1):e._e(),n("el-dialog",{attrs:{title:"处理理由选择",width:"400",visible:e.showReportBox},on:{"update:visible":function(t){e.showReportBox=t}}},[n("el-radio-group",{model:{value:e.reportType,callback:function(t){e.reportType=t},expression:"reportType"}},[n("div",[n("el-radio",{attrs:{label:1}},[e._v("辱骂")]),n("el-radio",{attrs:{label:2}},[e._v("色情")]),n("el-radio",{attrs:{label:3}},[e._v("垃圾广告")]),n("el-radio",{attrs:{label:4}},[e._v("引战")])],1),n("div",{staticStyle:{"margin-top":"20px"}},[n("el-radio",{attrs:{label:5}},[e._v("剧透")]),n("el-radio",{attrs:{label:6}},[e._v("人身攻击")]),n("el-radio",{attrs:{label:7}},[e._v("隐私侵犯")]),n("el-radio",{attrs:{label:8}},[e._v("刷屏")])],1),n("div",{staticStyle:{"margin-top":"20px"}},[n("el-radio",{attrs:{label:9}},[e._v("违法违规")]),n("el-radio",{attrs:{label:10}},[e._v("低俗")]),n("el-radio",{attrs:{label:11}},[e._v("赌博诈骗")]),n("el-radio",{attrs:{label:12}},[e._v("其他")])],1)]),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.cancelReport}},[e._v("取消")]),n("el-button",{attrs:{disabled:""===e.reportType,type:"primary"},on:{click:e.handleReport}},[e._v("确定")])],1)],1)],1)},Nn=[],Dn={name:"ReportList",data:function(){return{reports:"",page:"",showReportBox:!1,handleType:"",reportType:"",reportId:"",index:""}},methods:{initReport:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.getReorts(1,20,1);case 2:t=e.sent,n=t.data,0===n.code&&(this.reports=n.data.reports,this.page=n.data.page);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),handleReport:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.handleReport(this.reportId,{handleType:this.handleType,reportReason:this.reportType});case 2:t=e.sent,n=t.data,0===n.code?(this.$message({message:"处理成功",type:"success"}),this.reports.splice(this.index,1),this.initReport(),this.showReportBox=!1):this.$message({message:n.msg,type:"error"});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),handleCurrentChange:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.getReorts(t,20,"");case 2:n=e.sent,a=n.data,0===a.code&&(this.reports=a.data.reports,this.page=a.data.page);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),clickApprove:function(e,t){this.reportId=e,this.handleType=3,this.showReportBox=!0,this.index=t},clickDeny:function(e,t){this.reportId=e,this.handleType=2,this.index=t,this.showReportBox=!0},cancelReport:function(){this.reportType="",this.handleType="",this.reportId="",this.index="",this.showReportBox=!1}},created:function(){this.initReport()}},Ln=Dn,An=(n("XRuW"),Object(Re["a"])(Ln,jn,Nn,!1,null,"58d8cb3e",null)),zn=An.exports,Pn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"announce-list"},[n("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadMore,expression:"loadMore"}],staticClass:"announce-container",attrs:{"infinite-scroll-disabled":"busy","infinite-scroll-distance":"20"}},[e._l(e.announces,function(t){return n("div",{key:t.id,staticClass:"announce-item",class:{hlmp:t.isShowIndex}},[n("div",{staticClass:"page-container"},[n("div",{staticClass:"title-container"},[n("h1",[e._v(e._s(t.title))]),n("div",[n("span",[n("i",{staticClass:"el-icon-date",staticStyle:{"padding-right":"5px"},attrs:{title:"发布时间"}}),e._v(e._s(e._f("formatDate")(t.createTime)))]),n("span",{staticStyle:{"margin-left":"15px"}},[n("i",{staticClass:"el-icon-view",staticStyle:{"padding-right":"5px"},attrs:{title:"阅读量"}}),e._v(e._s(t.viewCount))])])]),n("div",{staticClass:"ann-oper"},[n("el-button",{on:{click:function(n){e.handleEdit(t)}}},[e._v("修改")]),n("el-button",{attrs:{type:"danger"},on:{click:function(n){e.handleDelete(t.id)}}},[e._v("删除")])],1)])])}),n("div",{directives:[{name:"show",rawName:"v-show",value:0===e.announces.length,expression:"announces.length===0"}]},[n("h1",[e._v("暂无公告")])])],2)])},Mn=[],qn={name:"AnnounceList",data:function(){return{announces:"",busy:!0,page:{pageNumber:0}}},directives:{infiniteScroll:ht.a},filters:{formatDate:function(e){var t=new Date(e);return Oe(t,"yyyy-MM-dd hh:mm")}},methods:{initAnnounce:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.getNotices();case 2:t=e.sent,n=t.data,0===n.code?(this.announces=n.data.notices,this.page=n.data.page):console.log("initAnnounces err!");case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),loadMore:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.busy=!0,setTimeout(Object(ke["a"])(regeneratorRuntime.mark(function e(){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.getNotices(t.page.pageNumber+1);case 2:n=e.sent,a=n.data,0===a.code?(a.data.notices.length>0&&(t.announces=t.announces.concat(a.data.notices),t.page=a.data.page,console.log("announces:",t.announces),console.log("page:",t.page)),console.log("loadMore get Data success")):console.log("loadMore失败");case 5:case"end":return e.stop()}},e,this)})),100),this.busy=!1;case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),handleEdit:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:console.log("edit announce!"),this.$router.push({name:"announcepost",params:{announce:t}});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),handleDelete:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.$confirm("删除该公告","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",callback:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(a,s){var i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(console.log(s),"confirm"!==a){e.next=6;break}return e.next=4,we.deleteNotice(t);case 4:i=e.sent,0===i.data.code?(console.log("删除成功，id:"+t),n.$message({showClose:!0,message:i.data.msg,type:"success"}),n.announces=n.announces.filter(function(e){return e.id!=t})):n.$message({showClose:!0,message:i.data.msg,type:"error"});case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()});case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},created:function(){this.initAnnounce()}},Vn=qn,Fn=(n("Iklr"),Object(Re["a"])(Vn,Pn,Mn,!1,null,"7d004303",null)),Hn=Fn.exports,Gn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"announce-post"},[n("div",{staticClass:"announce-inner"},[n("div",{staticClass:"announce-wrap"},[n("div",{staticClass:"announce-title"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.title,expression:"title"}],staticClass:"announce-text-area",staticStyle:{"overflow-y":"hidden",height:"104px"},attrs:{maxlength:"40",placeholder:"请输入标题（建议30字以内）"},domProps:{value:e.title},on:{input:function(t){t.target.composing||(e.title=t.target.value)}}}),n("span",{staticClass:"title-count"},[e._v("\n        "+e._s(e.titleWord)+"/40\n      ")])]),n("div",{staticClass:"editor"},[n("quill-editor",{ref:"myQuillEditor",attrs:{options:e.editorOption},on:{blur:function(t){e.onEditorBlur(t)},focus:function(t){e.onEditorFocus(t)},ready:function(t){e.onEditorReady(t)}},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1),n("div",[n("span",{staticStyle:{display:"inline-block",color:"#717171","margin-right":"10px"}},[e._v("在首页显示")]),n("el-switch",{attrs:{"active-color":"#3a86ef","inactive-color":"#777"},model:{value:e.showInMP,callback:function(t){e.showInMP=t},expression:"showInMP"}})],1)]),n("div",{staticClass:"post-announce-botton"},[n("el-button",{attrs:{type:"primary"},on:{click:e.postAnnounce}},[e._v("发布")]),n("el-button",{on:{click:e.preview}},[e._v("预览")])],1)])])},Qn=[],Jn=n("lT11"),Zn=n("Xd6r");n("p1OT"),n("gJae"),n("FOEY");Jn["Quill"].register("modules/ImageExtend",Zn["a"]);var Wn={name:"AnnouncePost",data:function(){var e=this;return{content:"",editorOption:{placeholder:"请输入内容",modules:{ImageExtend:{name:"image",size:10,action:this.GLOBAL.uploadURL,response:function(t){var n=t.data.link;n=n.substring(n.lastIndexOf("/")),console.log("link:",n);var a=e.GLOBAL.imgURL+n;return console.log("imgURL:",a),a},headers:function(e){e.setRequestHeader("Authorization","Client-ID 3855bbe9883a511")},sizeError:function(){e.$message({showClose:!0,message:"图片大小不能超过10MB",type:"error"})}},toolbar:{container:Zn["c"],handlers:{image:function(){Zn["b"].emit(this.quill.id)}}}}},title:"",showInMP:!1,editMode:!1,editAnnounce:""}},components:{quillEditor:Jn["quillEditor"]},methods:{onEditorBlur:function(e){console.log("editor blur!",e)},onEditorFocus:function(e){console.log("editor focus!",e)},onEditorReady:function(e){console.log("editor ready!",e)},postAnnounce:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n,a,s,i,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("post notice"),!this.editMode){e.next=15;break}if(t={title:this.title,content:this.content,isi:this.showInMP?1:0,nid:this.editAnnounce.id},""===this.title||""===this.content){e.next=12;break}return e.next=6,we.editNotice(t);case 6:n=e.sent,a=n.data,console.log(a),0===a.code?this.$message({message:"修改成功",type:"success"}):this.$message({message:a.msg,type:"error"}),e.next=13;break;case 12:this.$message({message:"请填写标题/内容",type:"error"});case 13:e.next=26;break;case 15:if(s={title:this.title,content:this.content,isi:this.showInMP?1:0},""===this.title||""===this.content){e.next=25;break}return e.next=19,we.postNotice(s);case 19:i=e.sent,r=i.data,console.log(r),0===r.code?this.$message({message:"发表成功",type:"success"}):this.$message({message:r.msg,type:"error"}),e.next=26;break;case 25:this.$message({message:"请填写标题/内容",type:"error"});case 26:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),preview:function(){console.log("preview!");var e=this.$router.resolve({name:"annpreview"});sessionStorage.setItem("annTitle",this.title),sessionStorage.setItem("annContent",this.content),console.log("href:",e.href),window.open(e.href,"_blank")}},computed:{editor:function(){return this.$refs.myQuillEditor.quill},titleWord:function(){return this.title.length}},mounted:function(){},created:function(){var e=this.$route.params.announce;console.log("get announce from param:",e),e&&(this.editMode=!0,this.editAnnounce=e,this.title=e.title,this.content=e.content)}},Kn=Wn,Xn=(n("rCJd"),n("aZZn"),Object(Re["a"])(Kn,Gn,Qn,!1,null,"08d69e68",null)),Yn=Xn.exports,ea=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"announce-prev"},[n("div",{staticClass:"page-container"},[n("div",{staticClass:"title-container"},[n("h1",[e._v(e._s(e.title))]),e._m(0)]),n("div",{staticClass:"content-container"},[n("div",{staticClass:"ctx-text",domProps:{innerHTML:e._s(e.content)}})]),n("div",{staticClass:"comment-container"}),n("div",{staticClass:"bottom-container"})])])},ta=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("span",[n("i",{staticClass:"el-icon-date",staticStyle:{"padding-right":"5px"},attrs:{title:"发布时间"}}),e._v("8102/12/23 12:00")]),n("span",{staticStyle:{"margin-left":"15px"}},[n("i",{staticClass:"el-icon-view",staticStyle:{"padding-right":"5px"},attrs:{title:"阅读量"}}),e._v("233")])])}],na={name:"AnnouncePreview",data:function(){return{title:"",content:""}},created:function(){this.title=sessionStorage.getItem("annTitle"),this.content=sessionStorage.getItem("annContent"),console.log("title:",this.title),console.log("content:",this.content)}},aa=na,sa=(n("lOZl"),n("qKL+"),Object(Re["a"])(aa,ea,ta,!1,null,"6ec6440f",null)),ia=sa.exports,ra=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"sys-notice"},[n("div",{staticClass:"sn-operation"},[n("el-button",{attrs:{type:"primary"},on:{click:e.initSysNotice}},[e._v("刷新系统消息")]),n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.sendByType=!0}}},[e._v("发送给特定群体")]),n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.sendByIds=!0}}},[e._v("发送给特定用户")])],1),n("div",{staticClass:"sn-list"},[e._l(e.notices,function(t,a){return n("div",{key:t.id,staticClass:"notice"},[n("div",{staticClass:"n-operation"},[n("el-button",{attrs:{disabled:"DELETE"===t.status,type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(n){e.deleteSysNotice(t.id,a)}}})],1),n("div",{staticClass:"n-title"},[e._v(e._s(t.title))]),n("div",{staticClass:"n-content",domProps:{innerHTML:e._s(t.content)}}),n("div",{staticClass:"n-misc"},[n("span",[e._v("id:"+e._s(t.id))]),n("span",[e._v("publisherUid:"+e._s(t.publisherUid))]),n("span",[e._v("sysMsgTargetType:"+e._s(t.sysMsgTargetType))]),n("span",[e._v("status:"+e._s(t.status))]),n("span",[e._v("ctime:"+e._s(new Date(t.createTime).toDateString()))])])])}),e.page&&e.notices.length>0?n("div",{staticClass:"pagination"},[e.page.totalSize>50?n("el-pagination",{attrs:{"current-page":e.page.pageNumber,"page-count":11,"page-size":e.page.pageSize,layout:"total, prev, pager, next, jumper",total:e.page.totalSize},on:{"current-change":e.pageSelect,"update:currentPage":function(t){e.$set(e.page,"pageNumber",t)}}}):e._e()],1):e._e()],2),n("el-dialog",{attrs:{title:"发送公告给某一群体","before-close":e.cancelSendInfo,visible:e.sendByType},on:{"update:visible":function(t){e.sendByType=t}}},[n("el-form",{staticClass:"small-space",staticStyle:{"margin-left":"50px"},attrs:{model:e.byType,"label-position":"left","label-width":"70px"}},[n("el-form-item",{attrs:{label:"type"}},[n("el-select",{attrs:{placeholder:"请选择群体"},model:{value:e.byType.type,callback:function(t){e.$set(e.byType,"type",t)},expression:"byType.type"}},[n("el-option",{attrs:{label:"用户",value:"0"}}),n("el-option",{attrs:{label:"管理员",value:"1"}}),n("el-option",{attrs:{label:"系统管理员",value:"2"}}),n("el-option",{attrs:{label:"全部",value:"3"}})],1)],1),n("el-form-item",{attrs:{label:"标题"}},[n("el-input",{model:{value:e.byType.title,callback:function(t){e.$set(e.byType,"title",t)},expression:"byType.title"}})],1),n("el-form-item",{attrs:{label:"内容"}},[n("el-input",{model:{value:e.byType.content,callback:function(t){e.$set(e.byType,"content",t)},expression:"byType.content"}})],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.cancelSendByType}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.sendSysNoticeByType}},[e._v("确 定")])],1)],1),n("el-dialog",{attrs:{title:"发送公告给特定用户","before-close":e.cancelSendInfo,visible:e.sendByIds},on:{"update:visible":function(t){e.sendByIds=t}}},[n("el-form",{staticClass:"small-space",staticStyle:{"margin-left":"50px"},attrs:{model:e.byIds,"label-position":"left","label-width":"70px"}},[n("el-form-item",{attrs:{label:"ids"}},[n("el-input",{model:{value:e.byIds.ids,callback:function(t){e.$set(e.byIds,"ids",t)},expression:"byIds.ids"}})],1),n("el-form-item",{attrs:{label:"标题"}},[n("el-input",{model:{value:e.byIds.title,callback:function(t){e.$set(e.byIds,"title",t)},expression:"byIds.title"}})],1),n("el-form-item",{attrs:{label:"内容"}},[n("el-input",{model:{value:e.byIds.content,callback:function(t){e.$set(e.byIds,"content",t)},expression:"byIds.content"}})],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.cancelSendByIds}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.sendSysNoticeByIds}},[e._v("确 定")])],1)],1)],1)},oa=[],ca=(n("KKXr"),{name:"SysNotice",data:function(){return{notices:[],byIds:{ids:"",title:"",content:""},byType:{type:"",title:"",content:""},sendByIds:!1,sendByType:!1,page:""}},methods:{initSysNotice:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.getSystemNotice(1,50);case 2:t=e.sent,n=t.data,0===n.code?(this.notices=n.data.messages,this.page=n.data.page):console.log("init system notice err.");case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),pageSelect:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.getSystemNotice(t,this.page.pageSize);case 2:n=e.sent,a=n.data,0===a.code?(this.notices=a.data.messages,this.page=a.data.page):console.log("page select err..");case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),sendSysNoticeByType:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n,a,s,i,r,o,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if((this.byType.type||0===this.byType.type)&&this.byType.title&&this.byType.content){e.next=2;break}return e.abrupt("return");case 2:if(3!=this.byType.type){e.next=18;break}return console.log("type == 3"),e.next=6,we.sendSystemNoticeByType(0,this.byType.title,this.byType.content);case 6:return t=e.sent,e.next=9,we.sendSystemNoticeByType(1,this.byType.title,this.byType.content);case 9:return n=e.sent,e.next=12,we.sendSystemNoticeByType(2,this.byType.title,this.byType.content);case 12:return a=e.sent,s=t.data,i=n.data,r=a.data,0===s.code&&0===i.code&&0===r.code?(this.notices.unshift(s.data),this.notices.unshift(i.data),this.notices.unshift(r.data),this.sendByType=!1,this.$message({message:"发送成功",type:"success"})):(console.log("send system notice to all err..."),this.$message({message:"发送失败",type:"error"})),e.abrupt("return");case 18:return e.next=20,we.sendSystemNoticeByType(this.byType.type,this.byType.title,this.byType.content);case 20:o=e.sent,c=o.data,0===c.code?(this.notices.unshift(c.data),console.log("notice res: ",c.data),this.sendByType=!1,this.$message({message:"发送成功",type:"success"})):(console.log("send notice err"),this.$message({message:c.msg,type:"error"}));case 23:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),sendSysNoticeByIds:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n,a,s,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.byIds.ids&&this.byIds.title&&this.byIds.content){e.next=2;break}return e.abrupt("return");case 2:return t=this.byIds.ids.split(","),t.pop(),console.log("tmp:",t),n=t.map(function(e){return parseInt(e)}),console.log("ids:",n),e.next=9,we.sendSystemNoticeByIds(n,this.byIds.title,this.byIds.content);case 9:a=e.sent,s=a.data,0===s.code?(i={id:s.data,title:this.byIds.title,content:this.byIds.content,createTime:(new Date).toDateString(),status:"NORMAL",publisherUid:localStorage.getItem("uid"),sysMsgTargetType:"给特定用户"},console.log("tmpRes:",i),this.notices.unshift(i),this.sendByIds=!1,this.$message({message:"发送成功",type:"success"})):(console.log("send notice err..."),this.$message({message:s.msg,type:"error"}));case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),deleteSysNotice:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(t,n){var a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.$confirm("删除系统消息："+t,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",callback:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(s,i){var r,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(console.log(i),"confirm"!==s){e.next=13;break}if("number"!==typeof t){e.next=8;break}return e.next=5,we.deleteSystemNotice(t);case 5:r=e.sent,e.next=11;break;case 8:return e.next=10,we.deleteIdsSystemNotice(t);case 10:r=e.sent;case 11:o=r.data,0===o.code?(a.notices.splice(n,1),a.$message({message:"通知已被删除",type:"success"})):(console.log("del system notice err."),a.$message({message:"删除失败",type:"error"}));case 13:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()});case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),cancelSendByType:function(){this.byType.type="",this.byType.content="",this.byType.title="",this.sendByType=!1},cancelSendByIds:function(){this.byIds.ids="",this.byIds.title="",this.byIds.content="",this.sendByIds=!1},cancelSendInfo:function(e){this.byType.type="",this.byType.content="",this.byType.title="",this.byIds.ids="",this.byIds.title="",this.byIds.content="",this.sendByType=!1,this.sendByIds=!1,e()}},created:function(){this.initSysNotice()}}),la=ca,ua=(n("cPg2"),Object(Re["a"])(la,ra,oa,!1,null,"d32c4266",null)),da=ua.exports,ma=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"log-container"},[n("div",{staticClass:"log-operation"},[n("el-button",{attrs:{disabled:""===e.intervalId,type:"primary"},on:{click:e.stopWatch}},[e._v("停止监控")]),n("el-button",{attrs:{disabled:""!==e.intervalId,type:"primary"},on:{click:e.startWatch}},[e._v("开始监控")]),n("el-button",{attrs:{type:"primary"},on:{click:e.showFullLogs}},[e._v("显示完整日志")]),n("el-button",{attrs:{type:"danger"},on:{click:e.shutDownApp}},[e._v("关闭应用")])],1),n("div",{staticClass:"log-area"},e._l(e.logs,function(t,a){return n("div",{key:a,staticClass:"log-entity"},[n("p",{staticClass:"log-text"},[e._v(e._s(t))])])}))])},pa=[],ga={name:"SystemLog",data:function(){return{logs:"",logsFull:"",intervalId:""}},methods:{getLogs:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.getLogs();case 2:t=e.sent,n=t.data,n&&(a=n.split("\n"),a.length>0&&(this.logs=a.splice(a.length<50?0:a.length-50)));case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),stopWatch:function(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId="",console.log("stop watching success"))},startWatch:function(){var e=this;""===this.intervalId&&(this.intervalId=setInterval(function(){e.getLogs()},1e4),console.log("start watching success"))},showFullLogs:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t,n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.logs=";",this.intervalId&&(clearInterval(this.intervalId),this.intervalId="",console.log("show full log and stop watching success")),e.next=4,we.getLogs();case 4:t=e.sent,n=t.data,n&&(a=n.split("\n"),a.length>0&&(this.logs=a));case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),shutDownApp:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.$confirm("确定关闭应用？关闭后无法从这里重新启动：","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",callback:function(){var e=Object(ke["a"])(regeneratorRuntime.mark(function e(n,a){var s,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(console.log(a),"confirm"!==n){e.next=8;break}return e.next=4,we.shutDownApp();case 4:s=e.sent,i=s.data,console.log("shutDown: ",i),i&&t.$message({message:"已关闭",type:"success"});case 8:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()});case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},created:function(){var e=this;this.getLogs(),this.intervalId=setInterval(function(){e.getLogs()},2e3)},beforeDestroy:function(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId="")}},ha=ga,fa=(n("q4+a"),Object(Re["a"])(ha,ma,pa,!1,null,"2ed94254",null)),va=fa.exports;a["default"].use(He["a"]);var ba=[{path:"/login",name:"Login",component:Ke},{path:"/announce/preview",name:"annpreview",component:ia},{path:"/",redirect:"/home/index",hidden:!0},{path:"/home",component:Pe,name:"home",children:[{path:"index",component:at,name:"index"},{path:"apitest",component:Be,name:"apitest"},{path:"user",component:De,name:"userlist"},{path:"userdetail/:uid",component:dt,name:"userdetail"},{path:"bangumi",component:Rt,name:"bangumilist"},{path:"bangumidetail/:bid",component:$t,name:"bangumidetail"},{path:"bangumiedit",component:At,name:"bangumiedit"},{path:"bangumi/userpost",component:Wt,name:"userpostbangumi"},{path:"episode",component:nn,name:"episodelist"},{path:"episodedetail/:eid",component:ln,name:"episodedetail"},{path:"video",component:hn,name:"videolist"},{path:"videodetail/:vid",component:xn,name:"videodetail"},{path:"video/userpost",component:Sn,name:"userpostvideo"},{path:"danmaku",component:Un,name:"danmakulist"},{path:"reportlist",component:zn,name:"reportlist"},{path:"announce",component:Hn,name:"announcelist"},{path:"announce/new",component:Yn,name:"announcepost"},{path:"snotice",component:da,name:"systemnotice"},{path:"online/users/:today",component:yt,name:"onlineuser"},{path:"log",component:va,name:"log"}]}],ya=new He["a"]({routes:ba}),wa=ya,xa=n("VYzq"),_a=n.n(xa),ka="imgur-api/3/image",Ca="imgur",Ia={Authorization:"Client-ID 3855bbe9883a511"},Ra={uploadURL:ka,imgURL:Ca,uploadHEADERS:Ia};a["default"].config.productionTip=!1,a["default"].use(i.a),a["default"].use(_a.a),a["default"].prototype.GLOBAL=Ra,wa.beforeEach(function(e,t,n){if(console.log("to.path:",e.path),console.log("from.path:",t.path),"/login"!==e.path){var a=localStorage.getItem("token"),s=localStorage.getItem("uid"),i=localStorage.getItem("nick");if(a&&s&&i){var r=localStorage.getItem("role");console.log("role:",r),"ROLE_USER"===r&&n("/login")}else n("/login")}console.log("next!"),n()}),new a["default"]({render:function(e){return e(Fe)},router:wa}).$mount("#app")},XRuW:function(e,t,n){"use strict";var a=n("Owhu"),s=n.n(a);s.a},XfUD:function(e,t,n){},Yp8L:function(e,t,n){"use strict";var a=n("bjDG"),s=n.n(a);s.a},ZL7j:function(e,t,n){"use strict";var a=n("EDI0"),s=n.n(a);s.a},aH7E:function(e,t,n){},aI2Y:function(e,t,n){},aZZn:function(e,t,n){"use strict";var a=n("2NF1"),s=n.n(a);s.a},bjDG:function(e,t,n){},bjQU:function(e,t,n){},byRC:function(e,t,n){"use strict";var a=n("y0yG"),s=n.n(a);s.a},cPg2:function(e,t,n){"use strict";var a=n("51L2"),s=n.n(a);s.a},e5wg:function(e,t,n){},gyWZ:function(e,t,n){"use strict";var a=n("pRs2"),s=n.n(a);s.a},hAJP:function(e,t,n){},iz4U:function(e,t,n){},kI7O:function(e,t,n){},kZym:function(e,t,n){"use strict";var a=n("tqF5"),s=n.n(a);s.a},lOZl:function(e,t,n){"use strict";var a=n("trAA"),s=n.n(a);s.a},n6MI:function(e,t,n){},oTPr:function(e,t,n){},pRs2:function(e,t,n){},"q4+a":function(e,t,n){"use strict";var a=n("THJW"),s=n.n(a);s.a},"qKL+":function(e,t,n){"use strict";var a=n("aI2Y"),s=n.n(a);s.a},rCJd:function(e,t,n){"use strict";var a=n("9EnR"),s=n.n(a);s.a},sbKH:function(e,t,n){"use strict";var a=n("Dh8X"),s=n.n(a);s.a},tqF5:function(e,t,n){},trAA:function(e,t,n){},y0yG:function(e,t,n){},z4It:function(e,t,n){"use strict";var a=n("D7j0"),s=n.n(a);s.a}});
//# sourceMappingURL=app.577188ab.js.map